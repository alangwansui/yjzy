<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>


        <record model="ir.ui.view" id="view_yfsqd_reconcile_tree">
            <field name="name">account.payment.reconcile.tree</field>
            <field name="model">account.payment</field>
            <field name="priority" eval="999"/>
            <field name="arch" type="xml">
                <tree string="预付核销单">
                    <field name="partner_id" string="对象"/>
                    <field name="name" string="编号"/>
                    <field name="po_id" string="采购合同"/>
                    <field name="yjzy_payment_advance_balance" string="未认领金额" groups="base.group_system"/>
                    <field name="amount" string="核销金额"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_ysrld_reconcile_tree">
            <field name="name">account.payment.reconcile.tree</field>
            <field name="model">account.payment</field>
            <field name="priority" eval="999"/>
            <field name="arch" type="xml">
                <tree string="预收核销单">
                    <field name="partner_id" string="对象"/>
                    <field name="name" string="编号"/>
                    <field name="so_id" string="销售合同"/>
                    <field name="yjzy_payment_advance_balance" string="未认领金额" groups="base.group_system"/>
                    <field name="amount" string="核销金额"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_yfhxd_reconcile_tree">
            <field name="name">account.payment.reconcile.tree</field>
            <field name="model">account.payment</field>
            <field name="priority" eval="999"/>
            <field name="arch" type="xml">
                <tree string="应付核销单">
                    <field name="invoice_attribute_all_in_one" string="类型"/>
                    <field name="partner_id" string="对象" groups="base.group_system"/>
                    <field name="name" string="编号"/>
                    <field name="invoice_log_id" string="应付账单"/>
                    <field name="amount_invoice_log" string="未认领金额" groups="base.group_system"/>
                    <field name="amount" string="核销金额"/>
                    <field name="state_1"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_yshxd_reconcile_tree">
            <field name="name">account.payment.reconcile.tree</field>
            <field name="model">account.payment</field>
            <field name="priority" eval="999"/>
            <field name="arch" type="xml">
                <tree string="应收核销单">
                    <field name="partner_id" string="对象" groups="base.group_system"/>
                    <field name="name" string="编号"/>
                    <field name="invoice_log_id" string="应收账单"/>
                    <field name="amount_invoice_log" string="未认领金额" groups="base.group_system"/>
                    <field name="amount" string="核销金额"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="view_ysrld_reconcile_form" model="ir.ui.view">
            <field name="name">account.payment.form</field>
            <field name="model">account.payment</field>
            <field name="arch" type="xml">
                <form string="结余核销单">
                    <header>
                        <button name="action_reconcile_submit" type="object" class="oe_highlight" string="提交审批"
                                attrs="{'invisible':[('state_1','!=','10_draft')]}"/>
                        <button name="action_reconcile_account" type="object" class="oe_highlight" string="财务审批"
                                attrs="{'invisible':[('state_1','!=','20_account_submit')]}"/>
                        <button name="action_reconcile_manager" type="object" class="oe_highlight" string="总经理审批"
                                attrs="{'invisible':[('state_1','!=','30_manager_approve')]}"/>
                        <button name="action_draft_new" class="oe_highlight" string="重置草稿" type="object"
                                attrs="{'invisible':[('state_1','not in',['80_refused'])]}"/>

                        <button name="%(payment_refuse_wizard_action)d" string="财务拒绝" type="action"
                                attrs="{'invisible': [('state_1','not in',['20_account_submit'])]}"
                        />
                        <button name="%(payment_refuse_wizard_action)d" string="总经理拒绝" type="action"
                                attrs="{'invisible': [('state_1','not in',['30_manager_approve'])]}"/>
                        <field name="state_1" widget="statusbar" statusbar_visible=" "/>

                    </header>
                    <header groups="base.group_system">
                        <button name="compute_balance" class="oe_highlight" string="计算余额" type="object"
                                groups="base.group_system"/>
                        <button name="post" class="oe_highlight" states="draft" string="Confirm" type="object"
                                groups="base.group_system"/>
                        <button name="cancel" attrs="{'invisible': [('state', 'in', ['draft','cancelled'])]}"
                                string="Cancel" type="object" groups="base.group_system"/>
                        <button name="action_draft" class="oe_highlight" states="cancelled" string="Set To Draft"
                                type="object" groups="base.group_system"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,posted,reconciled,cancelled"/>

                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <field name="is_editable" widget="boolean_toggle" groups="sales_team.group_manager"/>
                            <!--                        <button class="oe_stat_button" name="open_account_invoice"  type="object" icon="fa-pencil-square-o" string="test"-->
                            <!--                                attrs="{'invisible':[('state','not in',['posted','reconciled'])]}">-->
                            <!--                            <field name="count_ysrld" widget="statinfo" nolabel="1"/>-->
                            <!--                        </button>-->

                            <button class="oe_stat_button" name="open_ysrl" type="object" icon="fa-pencil-square-o"
                                    string="预收认领"
                                    attrs="{'invisible':[('count_ysrld','=',0)]}">
                                <field name="count_ysrld" widget="statinfo" nolabel="1"/>
                            </button>
                            <button class="oe_stat_button" name="open_yshx" type="object" icon="fa-pencil-square-o"
                                    string="应收认领"
                                    attrs="{'invisible':[('count_yshx','=',0)]}">
                                <field name="count_yshx" widget="statinfo" nolabel="1"/>
                            </button>

                            <button class="oe_stat_button" name="open_fybg_qtsr" type="object" icon="fa-pencil-square-o"
                                    string="其他收入" invisible="1">
                                <field name="count_fybg" widget="statinfo" nolabel="1"/>
                            </button>
                            <button class="oe_stat_button" name="open_tb_po_invoice" type="object"
                                    icon="fa-pencil-square-o"
                                    string="其他收款"
                                    attrs="{'invisible':[('tb_po_invoice_ids_count','=',0)]}">
                                <field name="tb_po_invoice_ids_count" widget="statinfo" nolabel="1"/>
                            </button>
                            <button class="oe_stat_button" name="button_journal_entries"
                                    string="Journal Items" type="object"
                                    groups="base.group_system"
                                    attrs="{'invisible':[('move_line_ids','=',[])]}" icon="fa-bars"/>
                            <field name="move_line_ids" invisible="1"/>
                            <button class="oe_stat_button" name="button_invoices"
                                    string="Invoices" type="object" groups="base.group_system"
                                    attrs="{'invisible':[('has_invoices','=',False)]}" icon="fa-bars"/>
                            <button class="oe_stat_button" name="open_payment_matching_screen"
                                    string="Payment Matching" type="object" groups="base.group_system"
                                    attrs="{'invisible':[('move_reconciled','=',True)]}" icon="fa-university"/>
                            <field name="has_invoices" invisible="1"/>
                            <field name="move_reconciled" invisible="1"/>
                            <field name="is_editable" widget="boolean_toggle" groups="sales_team.group_manager"/>
                        </div>

                        <field name="id" invisible="1"/>
                        <div class="oe_title">
                            <h1>
                                <field name="sfk_type" readonly="1"/>
                                <!--                                <field name="name"/>-->
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="invoice_log_id" string="被核销对象" invisible="1" readonly="1"
                                       attrs="{'invisible':[('sfk_type','not in',['reconcile_yingshou','reconcile_yingfu'])]}"/>
                                <field name="yjzy_payment_id" string="被核销对象" readonly="1" invisible="1"
                                       attrs="{'invisible':[('sfk_type','not in',['reconcile_ysrld','reconcile_yfsqd'])]}"
                                       domain="['|','&amp;','&amp;','&amp;',('state','=','posted'),('sfk_type','=','rcskd'),('partner_id','=',partner_id),('balance','!=',0),'&amp;','&amp;','&amp;',('state','=','posted'),('sfk_type','=','rcskd'),('partner_id.name','=','未定义'),('balance','!=',0)]"
                                       options="{'no_create':True}"
                                       context="{'form_view_ref': 'yjzy_extend.view_rcskd_form','advance_bank_amount':1}"/>
                                <field name="invoice_log_currency_id" options="{'no_open':1}"
                                       attrs="{'invisible':[('sfk_type','not in',['reconcile_yingshou','reconcile_yingfu'])]}"/>

                                <label name="invoice_log_id_this_time" string="本次核销前余额"
                                       attrs="{'invisible':[('sfk_type','not in',['reconcile_yingshou','reconcile_yingfu'])]}"/>
                                <div class="oe_row">
                                    <button type="object" name="open_invoice_id" class="btn-xxs btn-link mb2"
                                            target="new"
                                            attrs="{'invisible':[('sfk_type','not in',['reconcile_yingshou','reconcile_yingfu'])]}">
                                        <field name="invoice_log_id_this_time"
                                               attrs="{'invisible':[('sfk_type','not in',['reconcile_yingshou','reconcile_yingfu'])]}"/>
                                    </button>
                                    <button name="action_confirm_amount" type="object" string="确认核销金额"
                                            class="btn-xxs btn-link mb2"
                                            attrs="{'invisible':['|',('amount_state','=',True),('sfk_type','not in',['reconcile_yingshou','reconcile_yingfu'])]}"/>
                                </div>

                                <field name="amount_invoice_log" invisible="1"
                                       attrs="{'invisible':[('sfk_type','not in',['reconcile_yingshou','reconcile_yingfu'])]}"
                                       string="本次核销前余额"/>
                                <field name="invoice_log_id_after"
                                       attrs="{'invisible':[('sfk_type','not in',['reconcile_yingshou','reconcile_yingfu'])]}"
                                       string="本次核销后余额"/>

                                <field name="yjzy_payment_currency_id" string="货币" invisible="1"
                                       options="{'no_create':True,'no_open': True}"/>

                                <label name="yjzy_payment_advance_balance_this_time" string="本次核销前余额"
                                       attrs="{'invisible':[('sfk_type','not in',['reconcile_ysrld','reconcile_yfsqd'])]}"/>
                                <div class="oe_row">
                                    <button type="object" name="open_yfsqd" class="btn-xxs btn-link mb2" target="new"
                                            attrs="{'invisible':[('sfk_type','not in',['reconcile_ysrld','reconcile_yfsqd'])]}">
                                        <field name="yjzy_payment_advance_balance_this_time" string="未认领金额"
                                               attrs="{'invisible':[('sfk_type','not in',['reconcile_ysrld','reconcile_yfsqd'])]}"/>
                                    </button>
                                    <button name="action_confirm_amount" type="object" string="确认核销金额"
                                            class="btn-xxs btn-link mb2 oe_highlight"
                                            attrs="{'invisible':['|',('amount_state','=',True),('sfk_type','not in',['reconcile_ysrld','reconcile_yfsqd'])]}"/>
                                </div>


                                <field name="yjzy_payment_advance_balance"
                                       attrs="{'invisible':[('sfk_type','not in',['reconcile_ysrld','reconcile_yfsqd'])]}"
                                       string="未认领金额"/>
                                <field name="yjzy_payment_advance_balance_after"
                                       attrs="{'invisible':[('sfk_type','not in',['reconcile_ysrld','reconcile_yfsqd'])]}"
                                       string="本次核销后余额"/>
                                <field name="so_id" string="销售合同" readonly="1"
                                       attrs="{'invisible':[('sfk_type','!=','reconcile_ysrld')],'readonly': [('state', '!=', 'draft'),('is_editable','=',False)]}"
                                       domain="[('partner_id','=', partner_id),('state','not in',['done','verifying','verification','cancel','refuse'])]"
                                       options="{'no_create':True,'no_open': True}"/>
                                <field name="po_id" string="采购合同" readonly="1"
                                       attrs="{'invisible':[('sfk_type','!=','reconcile_yfsqd')],'readonly': [('state', '!=', 'draft'),('is_editable','=',False)]}"
                                       domain="[('partner_id','=', partner_id),('state','not in',['done','verifying','verification','cancel','refuse'])]"
                                       options="{'no_create':True,'no_open': True}"/>
                                <label for="amount" string="核销金额"/>
                                <div name="amount_div" class="o_row" string="收款金额"
                                     attrs="{'invisible':[('amount_state','=',False)]}">
                                    <field name="amount"
                                           attrs="{'invisible':[('amount_state','=',False)],'readonly': ['|',('amount_state','=',True),('state', '!=', 'draft')]}"/>
                                    <field name="currency_id" options="{'no_create': True, 'no_open': True}"
                                           groups="base.group_multi_currency" invisible="0"
                                           attrs="{'invisible':[('amount_state','=',False)],'readonly': ['|',('amount_state','=',True),('state', '!=', 'draft')]}"/>
                                </div>

                                <field name="hide_payment_method" invisible="1"/>
                                <field name="payment_method_id" string=" " widget="radio"
                                       attrs="{'invisible': [('hide_payment_method', '=', True)], 'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="payment_method_code" invisible="1"/>
                            </group>
                            <group>
                                <field name="payment_date" string="核销日期"
                                       attrs="{'readonly': [('state', '!=', 'draft')]}"/>

                                <field name="payment_type" widget="radio" readonly="1" required="1" invisible="1"/>
                                <field name="partner_type" widget="selection" invisible="1"
                                       attrs="{'required': [('payment_type', 'in', ('inbound', 'outbound'))], 'invisible': [('payment_type', 'not in', ('inbound', 'outbound'))], 'readonly': 1 }"/>
                                <field name="be_renling" invisible="1"/>
                                <field name="advance_ok" label="是否预收" string="是预收" invisible="1"/>


                                <field name="communication"
                                       attrs="{'invisible': [('state', '!=', 'draft'), ('communication', '=', False)], 'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="fault_comments"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="认领日志">
                                <group col="2">
                                    <group string="认领财务日志">
                                        <field name="move_line_com_ids" readonly="1" colspan="2" nolabel="1">
                                            <tree default_order="create_date">
                                                <field name="create_date" string="日期"/>
                                                <field name="reconcile_type" string="属性"/>
                                                <field name="amount_this_time" string="发生金额"/>
                                                <field name="sslj_balance" string="实时剩余金额"/>
                                            </tree>
                                        </field>
                                    </group>
                                    <group string="所有流程日志">
                                        <field name="reconcile_order_ids" colspan="2" nolabel="1"
                                               attrs="{'invisible':[('reconcile_order_ids_count','=',0)]}">
                                            <tree>
                                                <field name="hxd_type_new"/>
                                                <field name="invoice_id" groups="base.group_system" string="应付账单"/>
                                                <field name="create_date" widget="date" string="创建日期"/>
                                                <field name="approve_date"/>
                                                <field name="amount_payment_org_new" string="实际申请金额"/>
                                                <field name="amount_advance_org_new" string="预付认领金额"/>
                                                <field name="state_1"/>
                                            </tree>

                                        </field>
                                        <field name="advance_reconcile_order_yjzy_line_ids" nolabel="1" colspan="2"
                                               attrs="{'invisible':[('advance_reconcile_order_yjzy_line_ids_count','=',0)]}">
                                            <tree>
                                                <field name="hxd_type_new"/>
                                                <field name="invoice_id" readonly="1" invisible="1"/>
                                                <field name="create_date" string="创建日期"/>
                                                <field name="approve_date"/>
                                                <field name="tb_contract_code"/>
                                                <field name="yjzy_currency_id" invisible="1"/>
                                                <field name="so_id"
                                                       attrs="{'column_invisible':[('parent.sfk_type','!=','ysrld')]}"/>
                                                <field name="po_id"
                                                       attrs="{'column_invisible':[('parent.sfk_type','!=','yfsqd')]}"/>
                                                <field name="amount_advance_org" string="认领金额"/>
                                                <field name="sfk_type" invisible="1"/>
                                                <field name="state_1"/>
                                            </tree>
                                        </field>
                                        <field name="payment_log_hexiao_ids" colspan="2" nolabel="1"
                                               attrs="{'invisible':[('payment_log_hexiao_ids_count','=',0)]}">
                                            <tree>
                                                <field name="sfk_type" string="类型"/>
                                                <field name="payment_date" string="日期"/>
                                                <field name="amount" string="金额"/>
                                                <field name="currency_id" invisible="1"/>
                                                <field name="state_1"/>
                                            </tree>
                                        </field>
                                        <field name="payment_log_hexiao_ids_count" invisible="1"/>
                                        <field name="advance_reconcile_order_yjzy_line_ids_count" invisible="1"/>
                                        <field name="reconcile_order_ids_count" invisible="1"/>
                                    </group>


                                </group>
                            </page>
                            <page groups="base.group_system">
                                <group>
                                    <field name="payment_log_no_done_ids" colspan="2" nolabel="1">
                                        <tree>
                                            <field name="sfk_type"/>
                                            <field name="payment_date"/>
                                            <field name="name"/>
                                            <field name="amount"/>
                                            <field name="invoice_log_id_this_time"/>
                                            <field name="state_1"/>
                                        </tree>
                                    </field>

                                    <field name="amount_state"/>
                                    <field name="journal_id" domain="[('type','=', 'renling')]" string="收款日记账"
                                           widget="selection"/>
                                    <field name="partner_id" options="{'no_create':True,'no_open': True}" invisible=""
                                           domain="[('is_company','=',True),('customer','=',True)]"
                                           attrs="{'required': [('payment_type', 'in', ('inbound', 'outbound'))], 'invisible': [('payment_type', 'not in', ('inbound', 'outbound'))], 'readonly': [('state', '!=', 'draft')]}"
                                           context="{'default_is_company': True, 'default_supplier': payment_type == 'outbound', 'default_customer': payment_type == 'inbound'}"/>
                                    <field name="advance_account_id" label="预收科目" string="预收科目"
                                           options="{'no_create':True}"
                                           invisible="0"/>
                                    <field name="gongsi_id" string="公司主体" options="{'no_create':True,'no_open': True}"/>
                                </group>
                            </page>
                        </notebook>

                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>


        <menuitem id="menu_yfhx_main_reconcile" parent="menu_residual_reconcile_apply" name="预付核销" sequence="10"/>
        <menuitem id="menu_yingfuhx_main_reconcile" parent="menu_residual_reconcile_apply" name="应付核销" sequence="10"/>

        <menuitem id="menu_create_to_sale_reconcile" parent="menu_sale_reconcile_apply" name="创建核销" sequence="10"
                  groups="base.group_system"/>
        <menuitem id="menu_create_to_purchase_reconcile" parent="menu_residual_reconcile_apply" name="创建核销"
                  sequence="10" groups="base.group_system"/>
        <menuitem id="menu_no_done_to_purchase_reconcile" parent="menu_residual_reconcile_apply" name="待批准核销"
                  sequence="20" groups="base.group_system"/>
        <menuitem id="menu_done_to_purchase_reconcile" parent="menu_residual_reconcile_apply" name="已批准核销" sequence="30"
                  groups="base.group_system"/>

        <record id="action_yfsqd_to_reconcile" model="ir.actions.act_window">
            <field name="name">未完成认领预付(打开后创建核销)</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">
                [('sfk_type','=','yfsqd'),('state','in',['reconciled','posted']),('advance_balance_total','!=',0)]
            </field>
            <field name="context">{'search_default_group_by_advance_type':1,'show_shoukuan': True,'default_sfk_type':
                'yfsqd','default_payment_type': 'outbound',
                'default_be_renling': True, 'default_advance_ok': True,'default_partner_type': 'supplier'}
            </field>
            <field name="search_view_id" ref="view_account_payment_search_new"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yfsqd_account_hexiao_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_yfsqd_form')})]"/>
        </record>
        <menuitem id="menu_yfsqd_to_reconcile" parent="menu_yfhx_main_reconcile" name="创建预付核销" sequence="10"
                  action="action_yfsqd_to_reconcile"/>

        <record id="action_ysrld_to_reconcile" model="ir.actions.act_window">
            <field name="name">未完成认领预收(打开后创建核销)</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">
                [('sfk_type','=','ysrld'),('state','in',['posted','reconciled']),('advance_balance_total','!=',0)]
            </field>
            <field name="context">{'search_default_group_by_advance_type':1,'show_shoukuan': True, 'default_sfk_type':
                'ysrld', 'default_payment_type': 'inbound',
                'default_be_renling': True,'default_advance_ok': True, 'default_partner_type': 'customer',}
            </field>
            <field name="search_view_id" ref="view_account_payment_search_new"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_ysrld_reconcile_tree_1')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_form')})]"/>
        </record>
        <menuitem id="menu_ysrld_to_reconcile" parent="menu_create_to_sale_reconcile" name="创建预收核销" sequence="30"
                  action="action_ysrld_to_reconcile"/>

        <record id="action_yfhxd_to_reconcile" model="ir.actions.act_window">
            <field name="name">未完成认领应付(打开后创建核销)</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">
                [('type','=','in_invoice'),('state','=','open'),('amount_payment_can_approve_all','!=',0)]
            </field>
            <field name="context">{'search_default_group_by_invoice_attribute_all_in_one':1,'only_ref':1,
                'default_type': 'in_invoice', 'type': 'in_invoice', 'journal_type': 'purchase',}
            </field>
            <field name="search_view_id" ref="view_account_invoice_new_filter"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('invoice_new_supplier_1_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_account_invoice_new_form_in_one')})]"/>
        </record>
        <menuitem id="menu_yfhxd_to_reconcile" parent="menu_yingfuhx_main_reconcile" name="创建应付核销" sequence="10"
                  action="action_yfhxd_to_reconcile"/>

        <record id="action_yshxd_to_reconcile" model="ir.actions.act_window">
            <field name="name">未完成认领应收(打开后创建核销)</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">
                [('type','=','out_invoice'),('state','=','open'),('yjzy_type_1','!=','back_tax'),('amount_payment_can_approve_all','!=',0)]
            </field>
            <field name="context">{'search_default_group_by_invoice_attribute_all_in_one':1,'only_ref':1,
                'default_type': 'out_invoice', 'type': 'out_invoice', 'journal_type': 'sale',}
            </field>
            <field name="search_view_id" ref="view_account_invoice_new_filter"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('invoice_new_1_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_account_invoice_new_form_in_one')})]"/>
        </record>
        <menuitem id="menu_yshxd_to_reconcile" parent="menu_create_to_sale_reconcile" name="创建应收核销" sequence="40"
                  action="action_yshxd_to_reconcile"/>

        <record id="action_yshxd_back_tax_to_reconcile" model="ir.actions.act_window">
            <field name="name">未完成认领退税(打开后创建核销)</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">
                [('type','=','out_invoice'),('state','=','open'),('yjzy_type_1','=','back_tax'),('amount_payment_can_approve_all','!=',0)]
            </field>
            <field name="context">{'search_default_group_by_invoice_attribute_all_in_one':1,'only_ref':1,
                'default_type': 'out_invoice', 'type': 'out_invoice', 'journal_type': 'sale',}
            </field>
            <field name="search_view_id" ref="view_account_invoice_new_filter"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('invoice_new_1_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_account_invoice_new_form_in_one')})]"/>
        </record>
        <menuitem id="menu_yshxd_back_tax_to_reconcile" parent="menu_create_to_sale_reconcile" name="创建退税核销"
                  sequence="50"
                  action="action_yshxd_back_tax_to_reconcile"/>


        <menuitem id="menu_sale_to_reconcile" parent="menu_sale_reconcile_apply" name="查询核销" sequence="20"/>
        <menuitem id="menu_purchase_to_reconcile" parent="menu_residual_reconcile_apply" name="查询核销" sequence="20"
                  groups="base.group_system"
        />


        <record id="action_yfsqd_reconcile" model="ir.actions.act_window">
            <field name="name">预付核销</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('sfk_type','=','reconcile_yfsqd')]</field>
            <field name="context">{'bank_amount':1,'show_shoukuan': True, 'default_sfk_type': 'reconcile_yfsqd',
                'default_payment_type': 'outbound',
                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'supplier',}
            </field>
            <field name="search_view_id" ref="view_account_payment_search_new"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yfsqd_reconcile_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>
        </record>
        <menuitem id="menu_yfsqd_reconcile" parent="menu_purchase_to_reconcile" name="预府核销" sequence="10"
                  action="action_yfsqd_reconcile"/>

        <record id="action_yfsqd_no_done_reconcile" model="ir.actions.act_window">
            <field name="name">待批准预付核销</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('sfk_type','=','reconcile_yfsqd'),('state_1','!=','60_done')]</field>
            <field name="context">{'search_default_group_by_state_1':1,'bank_amount':1,'show_shoukuan': True,
                'default_sfk_type': 'reconcile_yfsqd',
                'default_payment_type': 'outbound',
                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'supplier',}
            </field>
            <field name="search_view_id" ref="view_account_payment_search_new"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yfsqd_reconcile_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>
        </record>
        <menuitem id="menu_yfsqd_no_done_reconcile" parent="menu_yfhx_main_reconcile" name="待批准预付核销" sequence="10"
                  action="action_yfsqd_no_done_reconcile"/>

        <record id="action_yfsqd_done_reconcile" model="ir.actions.act_window">
            <field name="name">已批准预付核销</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('sfk_type','=','reconcile_yfsqd'),('state_1','=','60_done')]</field>
            <field name="context">{'bank_amount':1,'show_shoukuan': True, 'default_sfk_type': 'reconcile_yfsqd',
                'default_payment_type': 'outbound',
                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'supplier',}
            </field>
            <field name="search_view_id" ref="view_account_payment_search_new"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yfsqd_reconcile_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>
        </record>
        <menuitem id="menu_yfsqd_done_reconcile" parent="menu_yfhx_main_reconcile" name="已批准预付核销" sequence="10"
                  action="action_yfsqd_done_reconcile"/>


        <record id="action_ysrld_reconcile" model="ir.actions.act_window">
            <field name="name">预收核销</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('sfk_type','=','reconcile_ysrld')]</field>
            <field name="context">{'bank_amount':1,'show_shoukuan': True, 'default_sfk_type': 'reconcile_yfsqd',
                'default_payment_type': 'inbound',
                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'customer',}
            </field>
            <field name="search_view_id" ref="view_account_payment_search_new"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_ysrld_reconcile_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>
        </record>
        <menuitem id="menu_ysrld_reconcile" parent="menu_sale_to_reconcile" name="预收核销" sequence="10"
                  action="action_ysrld_reconcile"/>

        <record id="action_yfhxd_reconcile" model="ir.actions.act_window">
            <field name="name">应付核销</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('sfk_type','=','reconcile_yingfu')]</field>
            <field name="context">{'group_by_invoice_attribute_all_in_one':1, 'default_sfk_type': 'reconcile_yingfu',
                'default_payment_type': 'outbound',
                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'supplier',}
            </field>
            <field name="search_view_id" ref="view_account_payment_search_new"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yfhxd_reconcile_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>
        </record>
        <menuitem id="menu_yfhxd_reconcile" parent="menu_purchase_to_reconcile" name="应付核销" sequence="10"
                  groups="base.group_system"
                  action="action_yfhxd_reconcile"/>

        <record id="action_yfhxd_no_done_reconcile" model="ir.actions.act_window">
            <field name="name">待批准应付核销</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('sfk_type','=','reconcile_yingfu'),('state_1','!=','60_done')]</field>
            <field name="context">{'search_default_group_by_state_1':1, 'default_sfk_type': 'reconcile_yingfu',
                'default_payment_type': 'outbound',
                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'supplier',}
            </field>
            <field name="search_view_id" ref="view_account_payment_search_new"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yfhxd_reconcile_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>
        </record>
        <menuitem id="menu_yfhxd_no_done_reconcile" parent="menu_yingfuhx_main_reconcile" name="待批准应付核销" sequence="20"
                  action="action_yfhxd_no_done_reconcile"/>

        <record id="action_yfhxd_done_reconcile" model="ir.actions.act_window">
            <field name="name">已批准应付核销</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('sfk_type','=','reconcile_yingfu'),('state_1','=','60_done')]</field>
            <field name="context">{'search_default_group_by_invoice_attribute_all_in_one':1, 'default_sfk_type':
                'reconcile_yingfu',
                'default_payment_type': 'outbound',
                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'supplier',}
            </field>
            <field name="search_view_id" ref="view_account_payment_search_new"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yfhxd_reconcile_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>
        </record>
        <menuitem id="menu_yfhxd_done_reconcile" parent="menu_yingfuhx_main_reconcile" name="已批准应付核销" sequence="30"
                  action="action_yfhxd_done_reconcile"/>

        <!--        <record id="action_zzdyfhxd_reconcile" model="ir.actions.act_window">-->
        <!--            <field name="name">主应付核销</field>-->
        <!--            <field name="type">ir.actions.act_window</field>-->
        <!--            <field name="res_model">account.payment</field>-->
        <!--            <field name="view_type">form</field>-->
        <!--            <field name="view_mode">tree,form</field>-->
        <!--            <field name="domain">[('sfk_type','=','reconcile_yingfu'),('invoice_attribute_all_in_one','in',['主账单应付'])]</field>-->
        <!--            <field name="context">{'group_by_state_1':1, 'default_sfk_type': 'reconcile_yingfu',-->
        <!--                'default_payment_type': 'outbound',-->
        <!--                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'supplier',}-->
        <!--            </field>-->
        <!--            <field name="search_view_id" ref="view_account_payment_search_new"/>-->
        <!--            <field name="view_ids" eval="[(5, 0, 0),-->
        <!--                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yfhxd_reconcile_tree')}),-->
        <!--                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>-->
        <!--        </record>-->
        <!--        <menuitem id="menu_zzdyfhxd_reconcile" parent="menu_purchase_to_reconcile" name="主应付核销" sequence="10"-->
        <!--                  action="action_zzdyfhxd_reconcile"/>-->

        <!--        <record id="action_zjcgyfhxd_reconcile" model="ir.actions.act_window">-->
        <!--            <field name="name">增加采购应付核销</field>-->
        <!--            <field name="type">ir.actions.act_window</field>-->
        <!--            <field name="res_model">account.payment</field>-->
        <!--            <field name="view_type">form</field>-->
        <!--            <field name="view_mode">tree,form</field>-->
        <!--            <field name="domain">[('sfk_type','=','reconcile_yingfu'),('invoice_attribute_all_in_one','in',['增加采购应付'])]</field>-->
        <!--            <field name="context">{'group_by_state_1':1, 'default_sfk_type': 'reconcile_yingfu',-->
        <!--                'default_payment_type': 'outbound',-->
        <!--                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'supplier',}-->
        <!--            </field>-->
        <!--            <field name="search_view_id" ref="view_account_payment_search_new"/>-->
        <!--            <field name="view_ids" eval="[(5, 0, 0),-->
        <!--                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yfhxd_reconcile_tree')}),-->
        <!--                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>-->
        <!--        </record>-->
        <!--        <menuitem id="menu_zjcgfhxd_reconcile" parent="menu_purchase_to_reconcile" name="增加采购应付核销" sequence="20"-->
        <!--                  action="action_zjcgfhxd_reconcile"/>-->

        <!--        <record id="action_qtyfhxd_reconcile" model="ir.actions.act_window">-->
        <!--            <field name="name">其他应付核销</field>-->
        <!--            <field name="type">ir.actions.act_window</field>-->
        <!--            <field name="res_model">account.payment</field>-->
        <!--            <field name="view_type">form</field>-->
        <!--            <field name="view_mode">tree,form</field>-->
        <!--            <field name="domain">[('sfk_type','=','reconcile_yingfu'),('invoice_attribute_all_in_one','in',['其他应付'])]</field>-->
        <!--            <field name="context">{'group_by_state_1':1, 'default_sfk_type': 'reconcile_yingfu',-->
        <!--                'default_payment_type': 'outbound',-->
        <!--                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'supplier',}-->
        <!--            </field>-->
        <!--            <field name="search_view_id" ref="view_account_payment_search_new"/>-->
        <!--            <field name="view_ids" eval="[(5, 0, 0),-->
        <!--                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yfhxd_reconcile_tree')}),-->
        <!--                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>-->
        <!--        </record>-->
        <!--        <menuitem id="menu_qtyfhxd_reconcile" parent="menu_purchase_to_reconcile" name="其他应付核销" sequence="30"-->
        <!--                  action="action_qtyfhxd_reconcile"/>-->


        <record id="action_yshxd_reconcile" model="ir.actions.act_window">
            <field name="name">应收核销</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.payment</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('sfk_type','=','reconcile_yingshou')]</field>
            <field name="context">{'group_by_invoice_attribute_all_in_one':1, 'default_sfk_type': 'reconcile_yingshou',
                'default_payment_type': 'inbound',
                'default_be_renling': True, 'default_advance_ok': True, 'default_partner_type': 'customer',}
            </field>
            <field name="search_view_id" ref="view_account_payment_search_new"/>
            <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_yshxd_reconcile_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_ysrld_reconcile_form')})]"/>
        </record>
        <menuitem id="menu_yshxd_reconcile" parent="menu_sale_to_reconcile" name="应收核销" sequence="20"
                  action="action_yshxd_reconcile"/>

    </data>


</odoo>