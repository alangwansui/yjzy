<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="wizard_wizard_transport4so_form" model="ir.ui.view">
            <field name="name">wizard.transport4so.from</field>
            <field name="model">wizard.transport4so</field>
            <field name="arch" type="xml">
                <form string="创建发运单">
                    <group>
                        <div>为选中的销售订单创建发运单</div>
                        <field name="partner_id" groups="base.group_system"/>
                        <field name="gongsi_id" groups="base.group_system"/>
                        <field name="purchase_gongsi_id" groups="base.group_system"/>
                    </group>
                    <group invisible="not context.get('add_so')">
                        <field name="so_ids" nolabel="1" option="{'no_create': True}"
                               domain="[('purchase_gongsi_id', '=', purchase_gongsi_id),('gongsi_id', '=', gongsi_id),('partner_id','=', partner_id),('delivery_status', '!=', 'received'),('state', 'in',['sale','verifying'])]"/>
                    </group>


                    <group invisible="not context.get('add_sol')">
                        <field name="sol_ids" nolabel="1" option="{'no_create': True}" widget="many2many"
                               domain="[('order_id.partner_id','=', partner_id),('new_rest_tb_qty', '!=', 0),('order_id.delivery_status', '!=', 'received'),('order_id.state','in',['sale','verifying']),
                                                ('order_id.purchase_gongsi_id', '=', purchase_gongsi_id),('order_id.gongsi_id', '=', gongsi_id)]"
                               context="{'tree_view_ref':'yjzy_extend.new_order_line_transport_tree'}">
                            <tree>
                                <field name="order_id"/>
                                <field name="product_id"/>
                            </tree>
                        </field>

                    </group>

                    <group invisible="not context.get('check_same')">
                        <field name="incoterm"/>
                        <field name="payment_term_id"/>
                        <field name="currency_id"/>
                        <field name="include_tax"/>

                        <field name="sale_order_ids">
                            <tree>
                                <field name="name"/>
                                <field name="incoterm"/>
                                <field name="payment_term_id"/>
                                <field name="currency_id"/>
                                <field name="include_tax"/>

                                <field name="state"/>

                            </tree>
                        </field>
                    </group>


                    <footer>
                        <button name="check_apply" class="oe_highlight" type='object' string="检查后确认"/>
                        <button name="new_apply" class="oe_highlight" type='object' string="确认:新" invisible="not context.get('add_sol')"/>
                        <button name="apply" class="oe_highlight" type='object' string="确认" invisible="not context.get('add_so')"/>
                        <button special="cancel" class="oe_highlight" string="取消"/>
                    </footer>
                </form>
            </field>
        </record>

        <!--
              <act_window id="act_wizard_transport4so"
                          name="创建发运单"
                          res_model="wizard.transport4so"
                          view_mode="form"
                          src_model="sale.order"
                          target="new"
                          key2="client_action_multi"
              />
              -->


    </data>
</odoo>

