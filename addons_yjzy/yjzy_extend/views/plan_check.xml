<?xml version="1.0" encoding="utf-8"?>
<odoo>


    <record id="view_order_track_search" model="ir.ui.view">
        <field name="name">order.track.select</field>
        <field name="model">order.track</field>
        <field name="arch" type="xml">
            <search string="Order Track">
                <field name="name" string="模糊搜索"
                       filter_domain="['|','|',('tb_id','ilike',self),('so_id','ilike',self),('po_ids','ilike',self)]"/>
                <separator/>
                <filter name="new_order_state_doing" string="未完成"
                        domain="[('order_track_new_order_state','=', '10_doing')]"
                        invisible="context.get('type')!='new_order_track'"/>
                <filter name="new_order_state_done" string="已完成"
                        domain="[('order_track_new_order_state','=', '20_done')]"
                        invisible="context.get('type')!='new_order_track'"/>
                <filter name="hegui_date" string="合规审批未完成" domain="[('hegui_date','=', False)]"
                        invisible="context.get('type')!='new_order_track'"/>

                <filter string="Late Activities" name="activities_overdue" invisible="1"
                        domain="[('activity_ids.date_deadline', '&lt;', context_today().strftime('%Y-%m-%d'))]"
                        help="Show all records which has next action date is before today"/>
                <filter string="Today Activities" name="activities_today" invisible="1"
                        domain="[('activity_ids.date_deadline', '=', context_today().strftime('%Y-%m-%d'))]"/>
                <filter string="Future Activities" name="activities_upcoming_all" invisible="1"
                        domain="[('activity_ids.date_deadline', '&gt;', context_today().strftime('%Y-%m-%d'))
                            ]"/>
                <group expand="1" string="Group By">
                    <filter string="客户" name="group_by_partner" domain="[]"
                            context="{'group_by':['partner_id']}"/>
                    <filter string="责任人" name="group_by_user_id" domain="[]"
                            context="{'group_by':['user_id']}"/>
                    <filter string="时间状态分组" name="group_date_all_state" domain="[]"
                            context="{'group_by':['date_all_state']}"
                            invisible="context.get('type')!='transport_track'"/>
                    <filter string="合规审批月" name="group_hegui_date" domain="[]"
                            context="{'group_by':['hegui_date:month']}"
                            invisible="context.get('type')=='transport_track'"/>
                    <filter string="客户交期月" name="group_date_so_requested" domain="[]"
                            context="{'group_by':['date_so_requested:month']}"
                            invisible="context.get('type')=='transport_track'"/>
                    <filter string="客户交期期限状态" name="group_ddate_so_requested_is_out_time" domain="[]"
                            context="{'group_by':['date_so_requested_is_out_time']}"
                            invisible="context.get('type')!='order_track'"/>
                    <filter string="新交期状态" name="group_date_so_requested_new_state" domain="[]"
                            context="{'group_by':['date_so_requested_new_state']}"
                            invisible="context.get('type')!='order_track'"/>
                    <filter string="下单前状态" name="group_new_order_state" domain="[]"
                            context="{'group_by':['order_track_new_order_state']}" invisible="1"/>
                </group>
            </search>
        </field>
    </record>


    <record id="view_plan_check_line_search" model="ir.ui.view">
        <field name="name">plan.check.line.select</field>
        <field name="model">plan.check.line</field>
        <field name="arch" type="xml">
            <search string="Order Track">
                <field name="po_id" string="模糊搜索"
                       filter_domain="['|',('po_id','ilike',self),('activity_type_1_id','ilike',self)]"/>
                <separator/>

                <filter string="Late Activities" name="activities_overdue" invisible="1"
                        domain="[('activity_ids.date_deadline', '&lt;', context_today().strftime('%Y-%m-%d'))]"
                        help="Show all records which has next action date is before today"/>
                <filter string="Today Activities" name="activities_today" invisible="1"
                        domain="[('activity_ids.date_deadline', '=', context_today().strftime('%Y-%m-%d'))]"/>
                <filter string="Future Activities" name="activities_upcoming_all" invisible="1"
                        domain="[('activity_ids.date_deadline', '&gt;', context_today().strftime('%Y-%m-%d'))
                            ]"/>

                <group expand="1" string="Group By">
                    <filter string="采购合同" name="group_by_po_id" domain="[]"
                            context="{'group_by':['po_id']}"/>
                    <filter string="检查单内容" name="group_activity_type_1_id" domain="[]"
                            context="{'group_by':['activity_type_1_id']}"/>
                    <filter string="状态" name="group_state" domain="[]"
                            context="{'group_by':['state']}"/>
                    <filter string="检查点计划-年" name="group_date_deadline_year" domain="[]"
                            context="{'group_by':['date_deadline:year']}"/>
                    <filter string="检查点计划-月" name="group_date_deadline_year" domain="[]"
                            context="{'group_by':['date_deadline:month']}"/>
                </group>
            </search>
        </field>
    </record>
    <!--    14.0-->
    <record id="view_plan_check_search" model="ir.ui.view">
        <field name="name">plan.check.select</field>
        <field name="model">plan.check</field>
        <field name="arch" type="xml">
            <search string="Plan Check">
                <field name="so_contract_code" string="模糊搜索"
                       filter_domain="['|',('so_id','ilike',self),('po_id','ilike',self),
                       ('so_contract_code','ilike',self),('po_contract_code','ilike',self)]"/>
                <separator/>

                <group expand="1" string="Group By">
                    <filter string="销售合同分组" name="group_so" domain="[]"
                            context="{'group_by':['so_id']}"
                            />
                    <filter string="工厂交期分组" name="group_date_po_planned_is_out_time" domain="[]"
                            context="{'group_by':['date_po_planned_is_out_time']}"
                            />
                    <filter string="销售合同工厂交期组合分组" name="group_date_po_planned_is_out_time_so" domain="[]"
                            context="{'group_by':['date_po_planned_is_out_time','so_id']}"
                            />



                </group>
            </search>
        </field>
    </record>


    <record id="order_track_tree_view" model="ir.ui.view">
        <field name="name">order.track.tree</field>
        <field name="model">order.track</field>
        <field name="arch" type="xml">
            <tree string="计划" create="false" default_order="date_so_requested,date_all_state" class="o_list_view_scroll"
                  decoration-danger="error_state == True">
                <field name="type" groups="base.group_system"/>
                <!--            <field name="date_deadline"/>-->
                <field name="order_track_new_order_state" invisible="1"/>

                <field name="partner_id"/>
                <field name="date_so_requested_is_out_time" invisible="1"/>
                <button name="open_so_id" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="context.get('type')!='new_order_track'"/>
                <field name="so_id" readonly="1" invisible="context.get('type')=='transport_track'"/>
                <field name="user_id" invisible="1"/>
                <field name="so_amount_total" invisible="context.get('type')=='transport_track'"/>
                <field name="currency_id" invisible="1"/>
                <field name="time_draft_order" readonly="1" widget="date" string="创建草稿时间"
                       invisible="context.get('type')!='new_order_track'"/>

                <field name="time_receive_pi" invisible="context.get('type')!='new_order_track'"/>
                <field name="time_sent_pi" invisible="context.get('type')!='new_order_track'"/>
                <field name="time_sign_pi" invisible="context.get('type')!='new_order_track'"/>
                <field name="hegui_date" invisible="context.get('type')=='transport_track'"/>
                <field name="approve_date" invisible="context.get('type')!='transport_track'"/>
                <button name="open_factory_return" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="context.get('type')!='new_order_track'"/>
                <field name="factory_return" widget="many2many_tags"
                       invisible="context.get('type')!='new_order_track'"/>
                <field name="plan_check_ids" widget="many2many_tags" groups="base.group_system"/>
                <field name="comments_new_order_track" invisible="context.get('type')!='new_order_track'"/>
                <field name="comments_new_order_track_date" invisible="context.get('type')!='new_order_track'"/>
                <button name="open_plan_check_line" type="object" string="工厂检查点登记" class="oe_highlight" invisible="1"/>
                <button name="open_plan_check_line_new" type="object" string="工厂检查点登记" class="oe_highlight"
                        invisible="1"/>


                <button name="open_planning_integrity" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="1"/>
                <field name="planning_integrity" invisible="1"/>
                <field name="order_track_plan_number" invisible="context.get('type')!='order_track'"/>
                <field name="order_track_finish_number" invisible="context.get('type')!='order_track'"/>
                <field name="order_track_due_number" invisible="context.get('type')!='order_track'"/>
                <field name="order_track_due_finish_number" invisible="context.get('type')!='order_track'"/>
                <field name="order_track_time_out_finish_number" invisible="context.get('type')!='order_track'"/>

                <field name="check_on_time" invisible="1"/>
                <field name="category_ids" string="异常结果" options="{'color_field':'color'}" widget="many2many_tags"
                       invisible="1"/>
                <field name="date_so_contract" invisible="context.get('type')!='order_track'" readonly="1"
                       string="客户确认日期"/>
                <field name="earliest_date_po_order" invisible="1" string="下单给供应商日期"/>
                <field name="latest_date_po_planned" invisible="context.get('type')!='order_track'" string="供应商交期"/>

                <field name="date_so_requested" invisible="context.get('type')!='order_track'" widget="date"
                       string="客户交期"/>
                <field name="date_so_requested_new" invisible="context.get('type_out')!='out_date'" widget="date"/>
                <field name="date_so_requested_change_date" invisible="context.get('type_out')!='out_date'"
                       widget="date"/>
                <field name="time_contract_requested" invisible="1"/>
                <field name="time_supplier_requested" invisible="1"/>
                <field name="check_all_number" invisible="1"/>
                <field name="check_finish_number" invisible="1"/>
                <!--                <field name="check_number_percent" widget="progressbar" string="工厂检查点进度"-->
                <!--                       invisible="context.get('type')!='order_track'"/>-->
                <field name="finish_percent" widget="progressbar" string="客户交期进度"
                       invisible="context.get('type')!='order_track'"/>
                <field name="finish_percent_supplier" widget="progressbar" string="供应商交期进度"
                       invisible="context.get('type')!='order_track'"/>
                <field name="so_all_qty" invisible="1"/>
                <field name="so_sent_qty" invisible="1"/>
                <field name="so_no_sent_qty" invisible="1"/>
                <field name="sent_amount_percent" widget="progressbar" string=" . .出运进度. . "
                       invisible="context.get('type')!='order_track'"/>
                <field name="so_no_sent_amount_new" invisible="context.get('type')!='order_track'"/>
                <field name="comments_order_track" invisible="context.get('type')!='order_track'"/>
                <field name="comments_order_track_date" invisible="context.get('type')!='order_track'"/>

                <button name="open_tb_id" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="context.get('type')!='transport_track'"/>

                <field name="tb_id" invisible="context.get('type')!='transport_track'"/>
                <field name="tb_org_sale_amount_new" invisible="context.get('type')!='transport_track'"/>
                <field name="date_out_in" invisible="context.get('type')!='transport_track'"
                       options='{"fg_color": "red:is_date_out_in == False"}' string="出运日期"/>
                <field name="tb_purchase_invoice_ids" widget="many2many_tags" string="工厂发货日期"
                       invisible="context.get('type')!='transport_track'"/>

                <button name="action_date_out_in" type="object" string="确认并生成应收付"
                        attrs="{'invisible':1}" confirm="确认后，应收应付就会生成，请谨慎！"
                        invisible="context.get('type')!='transport_track'"/>
                <field name="date_ship" invisible="context.get('type')!='transport_track'" string="船期"/>
                <field name="date_customer_finish" invisible="context.get('type')!='transport_track'" string="向客户交单日"/>

                <button name="open_order_track_tb" type="object" class="oe_stat_button" icon="fa-archive" string="工厂发货明细"
                        invisible="context.get('type')!='transport_track'"/>
                <field name="sale_invoice_balance" invisible="context.get('type')!='transport_track'" readonly="1"
                       />
                <field name="purchase_invoice_balance" invisible="context.get('type')!='transport_track'" readonly="1"
                       />
                <field name="back_tax_invoice_balance" invisible="context.get('type')!='transport_track'"
                       groups="base.group_system"/>
                <field name="zc_invoice_profile_residual_total_new" invisible="context.get('type')!='transport_track'"
                       groups="base.group_system"/>
                <field name="fzzc_back_tax_invoice_residual_total_new"
                       invisible="context.get('type')!='transport_track'" groups="base.group_system"/>

                <field name="tb_sale_invoice_id" invisible="1"/>
                <field name="is_date_out_in" invisible="1"/>
                <field name="comments_transport_track" invisible="context.get('type')!='transport_track'"/>
                <field name="comments_transport_track_date" invisible="context.get('type')!='transport_track'"/>
                <field name="error_state" groups="base.group_system"/>


            </tree>
        </field>
    </record>

    <record id="order_track_tree_view_out_time" model="ir.ui.view">
        <field name="name">order.track.tree</field>
        <field name="model">order.track</field>
        <field name="arch" type="xml">
            <tree string="计划" create="false" default_order="date_so_requested,date_all_state" class="o_list_view_scroll"
                  decoration-danger="error_state == True">
                <field name="type" groups="base.group_system"/>
                <!--            <field name="date_deadline"/>-->
                <field name="order_track_new_order_state" invisible="1"/>

                <field name="partner_id" readonly="1"/>
                <field name="date_so_requested_is_out_time" invisible="1"/>
                <button name="open_so_id" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="context.get('type')!='new_order_track'"/>
                <field name="so_id" readonly="1" invisible="context.get('type')=='transport_track'"/>
                <field name="user_id" invisible="1"/>
                <field name="so_amount_total" invisible="context.get('type')=='transport_track'" readonly="1"/>
                <field name="currency_id" invisible="1"/>
                <field name="time_draft_order" readonly="1" widget="date" string="创建草稿时间"
                       invisible="context.get('type')!='new_order_track'"/>
                <field name="date_so_requested_new_state" groups="base.group_system"/>
                <field name="time_receive_pi" invisible="context.get('type')!='new_order_track'"/>
                <field name="time_sent_pi" invisible="context.get('type')!='new_order_track'"/>
                <field name="time_sign_pi" invisible="context.get('type')!='new_order_track'"/>
                <field name="hegui_date" invisible="context.get('type')=='transport_track'" readonly="1"/>
                <field name="approve_date" invisible="context.get('type')!='transport_track'"/>
                <button name="open_factory_return" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="context.get('type')!='new_order_track'"/>
                <field name="factory_return" widget="many2many_tags"
                       invisible="context.get('type')!='new_order_track'"/>
                <field name="plan_check_ids" widget="many2many_tags" groups="base.group_system"/>
                <field name="comments_new_order_track" invisible="context.get('type')!='new_order_track'"/>
                <field name="comments_new_order_track_date" invisible="context.get('type')!='new_order_track'"/>
                <button name="open_plan_check_line" type="object" string="工厂检查点登记" class="oe_highlight" invisible="1"/>
                <button name="open_plan_check_line_new" type="object" string="工厂检查点登记" class="oe_highlight"
                        invisible="1"/>


                <button name="open_planning_integrity" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="1"/>
                <field name="planning_integrity" invisible="1"/>


                <field name="check_on_time" invisible="1"/>
                <field name="category_ids" string="异常结果" options="{'color_field':'color'}" widget="many2many_tags"
                       invisible="1"/>
                <field name="date_so_contract" invisible="context.get('type')!='order_track'" readonly="1"
                       string="客户确认日期"/>
                <field name="earliest_date_po_order" invisible="1" string="下单给供应商日期"/>
                <field name="latest_date_po_planned" invisible="context.get('type')!='order_track'" string="供应商交期"/>

                <field name="date_so_requested" invisible="context.get('type')!='order_track'" widget="date"
                       string="客户交期"/>
                <field name="date_so_requested_new" invisible="context.get('type_out')!='out_date'" widget="date" readonly="1"/>
                <button name="create_date_so_requested_new" string="填写新交期" type="object" icon="fa-clock-o"/>
                <field name="date_so_requested_change_date" invisible="context.get('type_out')!='out_date'"
                       widget="date" readonly="1"/>
                <field name="time_contract_requested" invisible="1"/>
                <field name="time_supplier_requested" invisible="1"/>
                <field name="check_all_number" invisible="1"/>
                <field name="check_finish_number" invisible="1"/>
                <!--                <field name="check_number_percent" widget="progressbar" string="工厂检查点进度"-->
                <!--                       invisible="context.get('type')!='order_track'"/>-->
<!--                <field name="finish_percent" widget="progressbar" string="客户交期进度"-->
<!--                       invisible="context.get('type')!='order_track'"/>-->
<!--                <field name="finish_percent_supplier" widget="progressbar" string="供应商交期进度"-->
<!--                       invisible="context.get('type')!='order_track'"/>-->
                <field name="so_all_qty" invisible="1"/>
                <field name="so_sent_qty" invisible="1"/>
                <field name="so_no_sent_qty" invisible="1"/>
<!--                <field name="sent_amount_percent" widget="progressbar" string=" . .出运进度. . "-->
<!--                       invisible="context.get('type')!='order_track'"/>-->
                <field name="so_no_sent_amount_new" invisible="context.get('type')!='order_track'"/>
                <field name="comments_order_track" invisible="context.get('type')!='order_track'" readonly="1"/>
                <field name="comments_order_track_date" invisible="context.get('type')!='order_track'" readonly="1"/>
                <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                <button name="open_tb_id" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="context.get('type')!='transport_track'"/>

                <field name="tb_id" invisible="context.get('type')!='transport_track'"/>
<!--                invisible="context.get('type')!='transport_track'"-->
                <field name="tb_org_sale_amount_new" invisible="1"  />


                <field name="date_out_in" invisible="context.get('type')!='transport_track'"
                       options='{"fg_color": "red:is_date_out_in == False"}'/>
                <button name="action_date_out_in" type="object" string="确认并生成应收付"
                        attrs="{'invisible':1}" confirm="确认后，应收应付就会生成，请谨慎！"
                        invisible="context.get('type')!='transport_track'"/>
                <field name="date_ship" invisible="context.get('type')!='transport_track'"/>
                <field name="date_customer_finish" invisible="context.get('type')!='transport_track'"/>
                <field name="tb_purchase_invoice_ids" widget="many2many_tags" string="工厂发货日期"
                       invisible="context.get('type')!='transport_track'"/>
                <button name="open_order_track_tb" type="object" class="oe_stat_button" icon="fa-archive" string="工厂发货明细"
                        invisible="context.get('type')!='transport_track'"/>
                <field name="sale_invoice_balance" invisible="context.get('type')!='transport_track'"
                       groups="base.group_system"/>
                <field name="purchase_invoice_balance" invisible="context.get('type')!='transport_track'"
                       groups="base.group_system"/>
                <field name="back_tax_invoice_balance" invisible="context.get('type')!='transport_track'"
                       groups="base.group_system"/>
                <field name="zc_invoice_profile_residual_total_new" invisible="context.get('type')!='transport_track'"
                       groups="base.group_system"/>
                <field name="fzzc_back_tax_invoice_residual_total_new"
                       invisible="context.get('type')!='transport_track'" groups="base.group_system"/>

                <field name="tb_sale_invoice_id" invisible="1"/>
                <field name="is_date_out_in" invisible="1"/>
                <field name="comments_transport_track" invisible="context.get('type')!='transport_track'"/>
                <field name="comments_transport_track_date" invisible="context.get('type')!='transport_track'"/>
                <field name="error_state" groups="base.group_system"/>
<!--                <field name="order_track_plan_number" invisible="context.get('type')!='order_track'"/>-->
<!--                <field name="order_track_finish_number" invisible="context.get('type')!='order_track'"/>-->
<!--                <field name="order_track_due_number" invisible="context.get('type')!='order_track'"/>-->
<!--                <field name="order_track_due_finish_number" invisible="context.get('type')!='order_track'"/>-->
<!--                <field name="order_track_time_out_finish_number" invisible="context.get('type')!='order_track'"/>-->

            </tree>
        </field>
    </record>

    <record id="order_track_tree_view_all" model="ir.ui.view">
        <field name="name">order.track.tree</field>
        <field name="model">order.track</field>
        <field name="arch" type="xml">
            <tree string="计划" create="false" default_order="date_so_requested,date_all_state" class="o_list_view_scroll"
                  decoration-danger="error_state == True">
                <field name="type" groups="base.group_system"/>
                <!--            <field name="date_deadline"/>-->
                <field name="order_track_new_order_state" invisible="1"/>

                <field name="partner_id"/>
                <field name="date_so_requested_is_out_time" invisible="1"/>
                <button name="open_so_id" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="context.get('type')!='new_order_track'"/>
                <field name="so_id" readonly="1" invisible="context.get('type')=='transport_track'"/>
                <field name="user_id" invisible="1"/>
                <field name="so_amount_total" invisible="context.get('type')=='transport_track'"/>
                <field name="currency_id" invisible="1"/>
                <field name="time_draft_order" readonly="1" widget="date" string="创建草稿时间"
                       invisible="context.get('type')!='new_order_track'"/>

                <field name="time_receive_pi" invisible="context.get('type')!='new_order_track'"/>
                <field name="time_sent_pi" invisible="context.get('type')!='new_order_track'"/>
                <field name="time_sign_pi" invisible="context.get('type')!='new_order_track'"/>
                <field name="hegui_date" invisible="context.get('type')=='transport_track'"/>
                <field name="approve_date" invisible="context.get('type')!='transport_track'"/>
                <button name="open_factory_return" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="context.get('type')!='new_order_track'"/>
                <field name="factory_return" widget="many2many_tags"
                       invisible="context.get('type')!='new_order_track'"/>
                <field name="plan_check_ids" widget="many2many_tags" groups="base.group_system"/>
                <field name="comments_new_order_track" invisible="context.get('type')!='new_order_track'"/>

                <button name="open_plan_check_line" type="object" string="工厂检查点登记" class="oe_highlight" invisible="1"/>
                <button name="open_plan_check_line_new" type="object" string="工厂检查点登记" class="oe_highlight"
                        invisible="1"/>


                <button name="open_planning_integrity" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="1"/>
                <field name="planning_integrity" invisible="1"/>
                <field name="order_track_plan_number" invisible="context.get('type')!='order_track'"/>
                <field name="order_track_finish_number" invisible="context.get('type')!='order_track'"/>
                <field name="order_track_due_number" invisible="context.get('type')!='order_track'"/>
                <field name="order_track_due_finish_number" invisible="context.get('type')!='order_track'"/>
                <field name="order_track_time_out_finish_number" invisible="context.get('type')!='order_track'"/>

                <field name="check_on_time" invisible="1"/>
                <field name="category_ids" string="异常结果" options="{'color_field':'color'}" widget="many2many_tags"
                       invisible="1"/>
                <field name="date_so_contract" invisible="context.get('type')!='order_track'" readonly="1"
                       string="客户确认日期"/>
                <field name="earliest_date_po_order" invisible="1" string="下单给供应商日期"/>
                <field name="latest_date_po_planned" invisible="context.get('type')!='order_track'" string="供应商交期"/>

                <field name="date_so_requested" invisible="context.get('type')!='order_track'" widget="date"
                       string="客户交期"/>
                <field name="time_contract_requested" invisible="1"/>
                <field name="time_supplier_requested" invisible="1"/>
                <field name="check_all_number" invisible="1"/>
                <field name="check_finish_number" invisible="1"/>
                <!--                <field name="check_number_percent" widget="progressbar" string="工厂检查点进度"-->
                <!--                       invisible="context.get('type')!='order_track'"/>-->
                <field name="finish_percent" widget="progressbar" string="客户交期进度"
                       invisible="context.get('type')!='order_track'"/>
                <field name="finish_percent_supplier" widget="progressbar" string="供应商交期进度"
                       invisible="context.get('type')!='order_track'"/>
                <field name="so_all_qty" invisible="1"/>
                <field name="so_sent_qty" invisible="1"/>
                <field name="so_no_sent_qty" invisible="1"/>
                <field name="sent_amount_percent" widget="progressbar" string=" . .出运进度. . "
                       invisible="context.get('type')!='order_track'"/>
                <field name="so_no_sent_amount_new" invisible="context.get('type')!='order_track'"/>
                <field name="comments_order_track" invisible="context.get('type')!='order_track'"/>


                <button name="open_tb_id" class="akiny_text_right" type="object" icon="fa-archive"
                        invisible="context.get('type')!='transport_track'"/>

                <field name="tb_id" invisible="context.get('type')!='transport_track'"/>
                <field name="tb_org_sale_amount_new" invisible="context.get('type')!='transport_track'"/>


                <field name="date_out_in" invisible="context.get('type')!='transport_track'"
                       options='{"fg_color": "red:is_date_out_in == False"}'/>
                <button name="action_date_out_in" type="object" string="确认并生成应收付"
                        attrs="{'invisible':1}" confirm="确认后，应收应付就会生成，请谨慎！"
                        invisible="context.get('type')!='transport_track'"/>
                <field name="date_ship" invisible="context.get('type')!='transport_track'"/>
                <field name="date_customer_finish" invisible="context.get('type')!='transport_track'"/>
                <field name="tb_purchase_invoice_ids" widget="many2many_tags" string="供应商交单日期"
                       invisible="context.get('type')!='transport_track'"/>
                <button name="open_order_track_tb" type="object" class="oe_stat_button" icon="fa-archive" string="供应商交单"
                        invisible="context.get('type')!='transport_track'"/>
                <field name="sale_invoice_balance" invisible="context.get('type')!='transport_track'" string="剩余应收款"
                       groups="account.group_account_invoice"/>
                <field name="purchase_invoice_balance" invisible="context.get('type')!='transport_track'" string="剩余应付款"
                       groups="account.group_account_invoice"/>
                <field name="back_tax_invoice_balance" invisible="context.get('type')!='transport_track'" string="剩余退税"
                       groups="account.group_account_invoice"/>
                <field name="tb_sale_invoice_id" invisible="1"/>
                <field name="is_date_out_in" invisible="1"/>
                <field name="comments_transport_track" invisible="context.get('type')!='transport_track'"/>
                <field name="error_state" groups="base.group_system"/>


            </tree>
        </field>
    </record>
    <!--    14.0-->
    <record id="plan_check_tree_view_purchase_order" model="ir.ui.view">
        <field name="name">plan.check.tree</field>
        <field name="model">plan.check</field>
        <field name="arch" type="xml">
            <tree delete="false" create="false"
                  decoration-danger="check_on_time == '20_out_time_un_finish'">
                <field name="order_track_id" groups="base.group_system"/>
                <field name="so_id" string="销售合同" readonly="1"/>
                <field name="po_id" readonly="1"/>
                <field name="plan_check_line"  readonly="1" string="检查点" groups="base.group_system"/>
                <field name="check_on_time" invisible="1"/>
                <field name="tb_id" invisible="1"/>
                <field name="order_track_plan_number" readonly="1"/>
                <field name="order_track_finish_number" readonly="1"/>
                <field name="order_track_due_number" readonly="1"/>
                <field name="order_track_due_finish_number" readonly="1"/>
                <field name="order_track_time_out_finish_number" class="akiny_text_left" readonly="1"/>
                <field name="date_po_planned" readonly="1"/>
                <field name="supplier_delivery_date" readonly="1"/>
                <field name="plan_check_att_count" invisible="1"/>
                <field name="is_purchase_invoice_finish" readonly="1"/>
                <button name="open_self" type="object" invisible="1" icon="fa-paperclip"/>
                <field name="comments" readonly="1"/>
                <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                <button name="open_planning_integrity" type="object" string="检查点计划登记"
                        invisible="context.get('type')!='order_track'" groups="base.group_system"/>


            </tree>
        </field>
    </record>

    <record id="plan_check_tree_view_purchase_out_time_order" model="ir.ui.view">
        <field name="name">plan.check.tree</field>
        <field name="model">plan.check</field>
        <field name="arch" type="xml">
            <tree delete="false" create="false"
                  decoration-danger="check_on_time == '20_out_time_un_finish'">
                <field name="order_track_id" groups="base.group_system"/>
                <field name="so_id" string="销售合同" readonly="1"/>
                <field name="po_id" readonly="1"/>
                <field name="plan_check_line"  readonly="1" string="检查点" groups="base.group_system"/>
                <field name="check_on_time" invisible="1"/>
                <field name="tb_id" invisible="1"/>
                <field name="order_track_plan_number" readonly="1"/>
                <field name="order_track_finish_number" readonly="1"/>
                <field name="order_track_due_number" readonly="1"/>
                <field name="order_track_due_finish_number" readonly="1"/>
                <field name="order_track_time_out_finish_number" class="akiny_text_left" readonly="1"/>
                <field name="date_po_planned" readonly="1"/>
                <field name="supplier_delivery_date" readonly="1"/>
                <field name="date_po_planned_new" invisible="context.get('type_out')!='out_date'" widget="date" readonly="1"/>
                <button name="create_date_po_planned_new" string="填写新交期" type="object" icon="fa-clock-o"/>
                <field name="date_po_planned_change_date" invisible="context.get('type_out')!='out_date'"
                       widget="date" readonly="1"/>
                <field name="plan_check_att_count" invisible="1"/>
                <field name="is_purchase_invoice_finish" readonly="1"/>
                <button name="open_self" type="object" invisible="1" icon="fa-paperclip"/>
                <field name="comments" readonly="1"/>
                <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                <button name="open_planning_integrity" type="object" string="检查点计划登记"
                        invisible="context.get('type')!='order_track'" groups="base.group_system"/>


            </tree>
        </field>
    </record>
    <record id="plan_check_form_purchase_order" model="ir.ui.view">
        <field name="name">plan.check.form</field>
        <field name="model">plan.check</field>
        <field name="arch" type="xml">
            <form string="检查点">
                <sheet>
                    <group col="2">
                        <group>
                            <field name="order_track_plan_number" readonly="1"/>
                            <field name="order_track_finish_number" readonly="1"/>
                            <field name="order_track_due_number" readonly="1"/>
                            <field name="order_track_due_finish_number" readonly="1"/>
                            <field name="order_track_time_out_finish_number" class="akiny_text_left" readonly="1"/>
                        </group>
                        <group>
                            <field name="so_id" string="销售合同" readonly="1"/>
                            <field name="po_id" readonly="1"/>
                            <field name="check_on_time" invisible="1"/>
                            <field name="tb_id" invisible="1"/>
                            <field name="supplier_delivery_date"/>
                            <field name="comments" readonly="1"/>
                            <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                            <button name="open_planning_integrity" type="object" string="检查点计划登记"
                                    invisible="context.get('type')!='order_track'" groups="base.group_system"/>
                        </group>
                    </group>
                    <notebook colspan="1">
                        <page string="General Information" attrs="{'invisible':[('type','!=','order_track')]}">
                            <field name="plan_check_line">
                                <tree>
                                    <field name="activity_type_1_id" readonly="1"/>
                                    <button name="open_activity_id_plan" class="akiny_text_right" type="object"
                                            icon="fa-archive" attrs="{'invisible':[('plan_check_id','=',False)]}"/>

                                    <field name="date_deadline"/>
                                    <button name="open_activity_id_finish" class="akiny_text_right" type="object"
                                            icon="fa-archive" attrs="{'invisible':[('plan_check_id','=',False)]}"/>

                                    <field name="date_finish"/>
                                    <field name="plan_check_id"/>

                                    <button name="open_activity_id" type="object" string="登记该项检查点"
                                            groups="base.group_system"
                                            attrs="{'invisible':[('plan_check_id','=',False)]}"/>
                                </tree>
                            </field>
                        </page>
                        <page string="manager" groups="base.system">
                            <field name="type"/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>


    <record id="order_track_form_purchase_order_date_so" model="ir.ui.view">
        <field name="name">order.track.form</field>
        <field name="model">order.track</field>
        <field name="arch" type="xml">
            <form string="检查点">
                <sheet>
                    <group >
                        <group>
                            <field name="id" readonly="1"/>
                            <field name="date_so_requested_new" widget="date"/>
                            <field name="date_so_requested_change_date" invisible="1"/>
                        </group>
                    </group>
                 <footer>
                        <button name="action_save_test" type="object" class="oe_highlight" string="保存并关闭"/>
                        <button string="关闭" class="btn-primary" special="cancel"/>
                    </footer>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>


    <record id="plan_check_date_po_planned_new_form" model="ir.ui.view">
        <field name="name">plan.check.form</field>
        <field name="model">plan.check</field>
        <field name="arch" type="xml">
            <form string="检查点">
                <sheet>
                    <group >
                        <group>
                            <field name="id" readonly="1"/>
                            <field name="date_po_planned_new" widget="date"/>
                            <field name="date_po_planned_change_date" invisible="1"/>
                        </group>
                    </group>
                 <footer>
                        <button name="action_save_test" type="object" class="oe_highlight" string="保存并关闭"/>
                        <button string="关闭" class="btn-primary" special="cancel"/>
                    </footer>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>


    <!--日期填制视图-->
    <record id="view_transport_bill_tenyale_date_tree" model="ir.ui.view">
        <field name="name">transport.bill.tree</field>
        <field name="model">transport.bill</field>
        <field name="arch" type="xml">
            <tree string="出运单" editable="bottom"
                  default_order="date_all_state, date_out_in desc,date_out_in_state desc">
                <field name="name" invisible="1"/>
                <field name="ref" readonly="1"/>
                <field name="partner_id" required="1" readonly="1"/>
                <!--button name="sync_data2invoice" string="创建应收付" attrs="{'invisible':[('state','!=','delivered')]}"  class="oe_highlight" type="object"/-->
                <field name="date_out_in" readonly="1"/>
                <field name="date_out_in_att" string=" " widget="many2many_binary" invisible="1"/>
                <field name="date_out_in_att_count" string=" "/>
                <button name="open_transport_self" icon="fa-paperclip" type="object"
                        context="{'form_xml_id': 'yjzy_extend.view_transport_bill_date_out_in'}" string="附件"/>
                <field name="date_out_in_state" readonly="1" string="状态"/>
                <field name="date_in" invisible="1"/>
                <field name="date_ship" readonly="1"/>
                <field name="date_ship_att" widget="many2many_binary" invisible="1"/>
                <field name="date_ship_att_count" string=" "/>

                <button name="open_transport_self" icon="fa-paperclip" type="object"
                        context="{'form_xml_id': 'yjzy_extend.view_transport_bill_date_ship'}" string="附件"/>
                <!--button name="open_transport_self" icon="fa-check" type="object"
                        context="{'form_xml_id': 'yjzy_extend.view_transport_bill_date_ship'}" attrs="{'invisible':[('date_ship_state','!=','done')]}"/-->
                <field name="date_ship_state" readonly="1" string="状态"/>

                <field name="date_customer_finish" readonly="1"/>
                <field name="date_customer_finish_att" widget="many2many_binary" invisible="1"/>
                <field name="date_customer_finish_att_count" string=" "/>
                <button name="open_transport_self" icon="fa-paperclip" type="object"
                        context="{'form_xml_id': 'yjzy_extend.view_transport_bill_date_customer_finish'}"
                        string="附件"/>
                <!--button name="open_transport_self" icon="fa-check" type="object"
                        context="{'form_xml_id': 'yjzy_extend.view_transport_bill_date_customer_finish'}" attrs="{'invisible':[('date_customer_finish_state','!=','done')]}"/-->
                <field name="date_customer_finish_state" readonly="1" string="状态"/>
                <field name="date_supplier_finish" invisible="1"/>
                <field name="all_purchase_invoice_fill" invisible="1"/>
                <field name="purchase_invoice_ids" widget="many2many_tags" invisible="1"/>
                <field name="purchase_invoice_ids2" widget="many2many_tags" string="供应商交单"
                       context="{'show_date_finish': 1}"/>
                <button name="open_purchase_invoice_1" type="object" class="oe_stat_button" icon="fa-paperclip"
                        string="供应商交单"/>
                <button name="update_supplier_invoice_date" string="供应商交单日期"
                        attrs="{'invisible':[('state','!=','invoiced')]}" class="oe_highlight" type="object"
                        invisible="1" icon="fa-pencil-square-o"/>

                <!--button icon="fa-check" attrs="{'invisible':[('date_purchase_finish_state','!=','done')]}"/-->
                <field name="date_purchase_finish_state" readonly="1" string="状态"/>


                <field name="state" invisible="1" readonly="1"/>
                <field name="create_date" widget="date" invisible="1"/>
                <field name="gongsi_id" string="销售主体" invisible="1"/>
                <field name="purchase_gongsi_id" string="采购主体" invisible="1"/>
            </tree>
        </field>
    </record>


    <record id="order_track_form" model="ir.ui.view">
        <field name="name">order.track.form</field>
        <field name="model">order.track</field>
        <field name="arch" type="xml">
            <form string="计划">
                <sheet>
                    <header>
                        <field name="order_track_new_order_state" widget="statusbar" nolabel="1"/>
                    </header>
                    <group attrs="{'invisible':[('type','!=','order_track')]}">
                        <group invisible="not context.get('order_track')">
                            <field name="type" groups="base.group_system"/>
                            <field name="so_id" readonly="1"/>
                            <field name="time_receive_pi" string="收到客户订单"/>
                            <field name="time_sent_pi"/>
                            <field name="time_sign_pi"/>
                        </group>
                        <group>
                            <field name="hegui_date" readonly="1"/>
                            <field name="earliest_date_po_order" string="最早供应商下单"/>
                            <field name="latest_date_po_planned" string="最迟供应商下单"/>
                        </group>
                        <group>
                            <field name="planning_integrity"/>
                        </group>
                    </group>
                    <notebook colspan="4">
                        <page string="General Information">
                            <field name="plan_check_ids"
                                   attrs="{'readonly':[('order_track_new_order_state','=','20_done')]}">
                                <tree editable="bottom" delete="false" create="false"
                                      decoration-danger="check_on_time == '20_out_time_un_finish'">
                                    <field name="order_track_id" groups="base.group_system"/>
                                    <field name="so_id" groups="base.group_system"/>
                                    <field name="po_id" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','=','transport_track')]}"/>
                                    <field name="plan_check_line" groups="base.group_system"/>
                                    <field name="date_factory_return"
                                           attrs="{'column_invisible':[('parent.type','!=','new_order_track')]}"/>
                                    <field name="check_on_time" invisible="1"/>
                                    <field name="tb_id" invisible="1"/>
                                    <field name="purchase_invoice_id" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','transport_track')]}"/>
                                    <field name="supplier_delivery_date" string='工厂实际发货日'
                                           options='{"fg_color": "red:is_supplier_delivery_date_earlier_approve_date == True"}'
                                           attrs="{'readonly':[('parent.order_track_new_order_state','=','20_done')],'column_invisible':[('parent.type','!=','transport_track')]}"/>
                                    <field name="is_supplier_delivery_date_earlier_approve_date" invisible="1"/>
                                    <field name="purchase_invoice_date_finish"
                                           attrs="{'readonly':[('parent.order_track_new_order_state','=','20_done')],'column_invisible':[('parent.type','!=','transport_track')]}"/>

                                    <field name="order_track_plan_number" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','order_track')]}"/>
                                    <field name="order_track_finish_number" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','order_track')]}"/>
                                    <field name="order_track_due_number" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','order_track')]}"/>
                                    <field name="order_track_due_finish_number" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','order_track')]}"/>
                                    <field name="order_track_time_out_finish_number" class="akiny_text_left"
                                           readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','order_track')]}"/>

                                    <field name="date_deadline" invisible="1"/>
                                    <field name="date_finish" invisible="1"/>
                                    <field name="plan_check_att_count"
                                           attrs="{'column_invisible':[('parent.type','=','new_order_track')]}"/>
                                    <button name="open_self" type="object" icon="fa-paperclip"
                                            attrs="{'column_invisible':[('parent.type','=','new_order_track')]}"/>
                                    <field name="comments" readonly="1"/>
                                    <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                                    <button name="open_planning_integrity" type="object" string="检查点计划登记"
                                            invisible="context.get('type')!='order_track'" groups="base.group_system"/>


                                </tree>
                            </field>
                            <field name="plan_check_line_ids"
                                   attrs="{'invisible':[('type','!=','order_track')],'readonly':[('order_track_new_order_state','=','20_done')]}">
                                <tree string="检查点" create="false" editable="bottom"
                                      decoration-danger="remaining_time &lt; 0 and remaining_time != -999">
                                    <field name="po_id" attrs="{'readonly':1}"/>
                                    <!--                                    <field name="date_order" widget="date" readonly="1"/>-->
                                    <field name="activity_type_1_id" domain="[('category','=','plan_check')]"
                                           options="{'no_open':1}"
                                           attrs="{'readonly':[('parent.order_track_new_order_state','=','20_done')]}"/>
                                    <button name="open_activity_id_plan" class="akiny_text_right" type="object"
                                            attrs="{'invisible':[('activity_id','=',False)],'readonly':['|',('activity_id','!=',False),('parent.order_track_new_order_state','=','20_done')]}"
                                            icon="fa-archive"/>
                                    <field name="date_deadline"
                                           attrs="{'readonly':['|',('activity_id','!=',False),('parent.order_track_new_order_state','=','20_done')]}"/>
                                    <field name="remaining_time" readonly="1"
                                           attrs="{'invisible':[('state','in',['35_advance_finish','40_finish','50_time_out_finish'])],'column_invisible':[('parent.order_track_new_order_state','=','20_done')]}"/>
                                    <button name="open_activity_id_finish" class="akiny_text_right" type="object"
                                            attrs="{'invisible':['|',('activity_id','=',False),('date_deadline','=',False)]}"
                                            icon="fa-archive"/>
                                    <field name="date_finish"
                                           attrs="{'readonly':['|',('activity_id','!=',False),('parent.order_track_new_order_state','=','20_done')]}"/>
                                    <field name="plan_check_line_att_count"/>
                                    <button name="open_self" type="object" icon="fa-paperclip"/>
                                    <field name="activity_id" groups="base.group_system"/>
                                    <field name="state"/>

                                    <button name="open_activity_id" type="object" string="登记该项检查点"
                                            groups="base.group_system"/>
                                </tree>
                            </field>
                        </page>
                        <page string="采购合同" attrs="{'invisible':[('type','!=','order_track')]}">
                            <field name="po_ids" readonly="1">
                                <tree>
                                    <field name="message_unread" invisible="1"/>
                                    <field name="name" string="流水码" groups="base.group_system" invisible="1"/>
                                    <field name="contract_code" string="合同编号"/>
                                    <field name="partner_id"/>
                                    <field name="date_order" string="下单日期" widget="date" invisible="1"/>
                                    <field name="create_date" widget="date" invisible="1"/>
                                    <field name="date_order" widget="date"/>
                                    <field name="date_planned" invisible="context.get('quotation_only', False)"
                                           string="交期" widget="date"/>
                                    <field name="date_factory_return" string="工厂回传日"/>
                                    <field name="origin" invisible="1"/>
                                    <field name="amount_untaxed" sum="Total Untaxed amount" string="Untaxed"
                                           widget="monetary" invisible="1"/>
                                    <field name="amount_total" sum="Total amount" string="金额" widget="monetary"/>
                                    <field name="balance" string="预付余额"/>
                                    <field name="currency_id" invisible="1"/>
                                    <field name="state" invisible="1"/>
                                    <field name="delivery_status" invisible="1"/>
                                    <field name="include_tax"/>
                                    <field name="payment_term_id" attrs="{}" invisible="1"/>
                                    <field name="sale_uid"/>
                                    <field name="sale_assistant_id" invisible="1"/>
                                    <field name="purchaser_date"/>
                                    <field name="so_id_state" string="销售审批状态" invisible="1"/>
                                    <field name="gongsi_id" string="采购主体" invisible="1"/>
                                    <field name="supplierinfo_ids" widget="many2many_tags" invisible="1"/>
                                    <field name="invoice_status"
                                           invisible="1"/><!--invisible="not context.get('show_purchase', True)"-->
                                    <field name="company_id" groups="base.group_system" invisible="1"
                                           options="{'no_create': True}"/>

                                </tree>
                            </field>
                        </page>
                        <page groups="base.group_system">
                            <group>
                                <field name="partner_id"/>
                                <field name="plan_date_out_in_activity" invisible="1"/>
                                <field name="plan_date_customer_finish_activity" invisible="1"/>
                                <field name="plan_date_ship_activity" invisible="1"/>
                                <field name="type" invisible="1"/>
                                <field name="is_date_out_in" invisible="1"/>
                                <field name="plan_date_customer_finish_error"/>
                                <field name="plan_date_out_in_error"/>
                                <field name="plan_date_ship_error"/>
                                <field name="check_all_number"/>
                                <field name="check_finish_number"/>
                            </group>
                        </page>

                    </notebook>
                    <footer invisible="not context.get('open')">
                        <button name="action_save_test" type="object" class="oe_highlight" string="保存并关闭"/>
                        <button string="关闭" class="btn-primary" special="cancel"/>
                    </footer>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="order_track_form_new" model="ir.ui.view">
        <field name="name">order.track.form</field>
        <field name="model">order.track</field>
        <field name="priority">10</field>
        <field name="arch" type="xml">
            <form string="计划" create="false">
                <style>
                    body{
                    font-size: 10px;
                    font-family:Arial;
                    }
                    .tablelist{

                    text-align: center;
                    border: 0.5px solid ;
                    border-collapse: collapse;
                    font-size: 10px;
                    width: 100%
                    }
                    .tablelist th{

                    font-size: 10px;
                    text-align: center;
                    border: 0.5px solid ;
                    height: 20px;
                    line-height: 20px;
                    }
                    .tablelist td{
                    border: 0.5px solid;
                    height: 20px;
                    line-height: 20px;

                    }
                </style>
                <header>
                    <button name="create_activity_plan_date_ship" type="object" string="test"
                            groups="base.group_system"/>
                    <button name="create_plan" type="object" string="test1" groups="base.group_system"/>
                    <button name="open_activity_id_date_out_in" type="object" string="完成进仓日"
                            groups="base.group_system"/>
                    <field name="order_track_new_order_state" widget="statusbar" nolabel="1" statusbar_visible=" "/>
                </header>
                <sheet>
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="tablelist"
                           attrs="{'invisible':[('type','!=','new_order_track')]}"
                    >
                        <tbody>
                            <tr>
                                <th width="10%">客户</th>
                                <th width="18%">销售合同</th>
                                <th width="10%">创建草稿时间</th>
                                <th width="10%">收到客户订单时间</th>
                                <th width="10%">发送PI时间</th>
                                <th width="10%">客户PI回签时间</th>
                                <th width="10%">合规审批时间</th>
                                <th width="18%">最后一次备注</th>
                                <th width="4%"></th>
                            </tr>
                            <tr>
                                <td>
                                    <field name="partner_id" readonly="1"/>
                                </td>
                                <td>
                                    <field name="so_id" readonly="1"/>
                                </td>
                                <td>
                                    <field name="time_draft_order"
                                           readonly="1"/>
                                </td>
                                <td>
                                    <field name="time_receive_pi"
                                           attrs="{'readonly':[('order_track_new_order_state','=','20_done')]}"/>
                                </td>
                                <td>
                                    <field name="time_sent_pi"
                                           attrs="{'readonly':[('order_track_new_order_state','=','20_done')]}"/>
                                </td>
                                <td>
                                    <field name="time_sign_pi"
                                           attrs="{'readonly':[('order_track_new_order_state','=','20_done')]}"/>
                                </td>
                                <td>
                                    <field name="hegui_date" readonly="1"/>
                                </td>
                                <td>
                                    <field name="comments_new_order_track" readonly="1"/>
                                </td>
                                <td>
                                    <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="tablelist"
                           attrs="{'invisible':['|',('type','!=','order_track'),('date_so_requested_is_out_time','=','40_in_out_time')]}">
                        <tbody>
                            <tr>
                                <th width="10%">销售合同</th>
                                <th width="5%">计划数</th>
                                <th width="5%">计划完成数</th>
                                <th width="5%">计划到期数</th>
                                <th width="5%">到期计划完成数</th>
                                <th width="8%">超时完成计划数</th>
                                <th width="8%">客户确认日期</th>
                                <th width="8%">合规审批日期</th>
                                <th width="8%">最迟供应商交期</th>
                                <th width="8%">客户交期</th>
                                <th width="8%">客户交期进度</th>
                                <th width="8%">供应商交期进度</th>
                                <th width="8%">出运进度</th>
                                <th width="8%">最后一次备注</th>
                                <th width="2%"></th>

                            </tr>
                            <tr>
                                <td>
                                    <field name="so_id" readonly="1"/>
                                </td>
                                <td>
                                    <field name="order_track_plan_number" readonly="1"/>
                                </td>
                                <td>
                                    <field name="order_track_finish_number" readonly="1"/>
                                </td>
                                <td>
                                    <field name="order_track_due_number" readonly="1"/>
                                </td>
                                <td>
                                    <field name="order_track_due_finish_number" readonly="1"/>
                                </td>
                                <td>
                                    <field name="order_track_time_out_finish_number" readonly="1"/>
                                </td>
                                <td>
                                    <field name="date_so_contract" readonly="1"/>
                                </td>
                                <td>
                                    <field name="hegui_date" readonly="1"/>
                                </td>
                                <td>
                                    <field name="latest_date_po_planned"/>
                                </td>
                                <td>
                                    <field name="date_so_requested" readonly="1" widget="date"/>
                                </td>

                                <td>
                                    <field name="finish_percent" widget="progressbar"/>
                                </td>
                                <td>
                                    <field name="finish_percent_supplier" widget="progressbar"/>
                                </td>
                                <td>
                                    <field name="sent_amount_percent" widget="progressbar"/>
                                </td>
                                <td>
                                    <field name="comments_order_track" readonly="1"/>
                                </td>
                                <td>
                                    <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                                </td>

                            </tr>
                        </tbody>
                    </table>
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="tablelist"
                           attrs="{'invisible':['|',('type','!=','order_track'),('date_so_requested_is_out_time','!=','40_in_out_time')]}">
                        <tbody>
                            <tr>
                                <th width="10%">销售合同</th>
                                <th width="5%">计划数</th>
                                <th width="5%">计划完成数</th>
                                <th width="5%">计划到期数</th>
                                <th width="5%">到期计划完成数</th>
                                <th width="8%">超时完成计划数</th>
                                <th width="8%">客户确认日期</th>
                                <th width="8%">合规审批日期</th>
                                <th width="8%">最迟供应商交期</th>
                                <th width="8%">客户交期</th>
                                <th width="8%">最新计划交期</th>
                                <th width="2%"></th>
                                <th width="8%">交期更新日期</th>
                                <th width="14%">最后一次备注</th>
                                <th width="2%"></th>

                            </tr>
                            <tr>
                                <td>
                                    <field name="so_id" readonly="1"/>
                                </td>
                                <td>
                                    <field name="order_track_plan_number" readonly="1"/>
                                </td>
                                <td>
                                    <field name="order_track_finish_number" readonly="1"/>
                                </td>
                                <td>
                                    <field name="order_track_due_number" readonly="1"/>
                                </td>
                                <td>
                                    <field name="order_track_due_finish_number" readonly="1"/>
                                </td>
                                <td>
                                    <field name="order_track_time_out_finish_number" readonly="1"/>
                                </td>
                                <td>
                                    <field name="date_so_contract" readonly="1"/>
                                </td>
                                <td>
                                    <field name="hegui_date" readonly="1"/>
                                </td>
                                <td>
                                    <field name="latest_date_po_planned"/>
                                </td>
                                <td>
                                    <field name="date_so_requested" readonly="1" widget="date"/>
                                </td>

                                <td>
                                    <field name="date_so_requested_new" widget="date" readonly="1"/>
                                </td>
                                <td>
                                    <button name="create_date_so_requested_new"  type="object" icon="fa-clock-o"/>
                                </td>
                                <td>
                                    <field name="date_so_requested_change_date" readonly="1"/>
                                </td>
                                <td>
                                    <field name="comments_order_track" readonly="1"/>
                                </td>
                                <td>
                                    <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                                </td>

                            </tr>
                        </tbody>
                    </table>
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="tablelist"
                           attrs="{'invisible':[('type','!=','transport_track')]}">
                        <tbody>
                            <tr>
                                <th width="18%">出运合同</th>
                                <th width="8%">审批日期</th>
<!--                                <th width="8%">剩余应收款</th>-->
<!--                                <th width="8%">剩余应付款</th>-->
<!--                                <th width="8%">剩余应收退税</th>-->

                                <th width="14%">
                                    <span style="color:red"
                                          attrs="{'invisible':[('plan_date_out_in_error','=',False)]}">进仓日期
                                    </span>
                                    <span attrs="{'invisible':[('plan_date_out_in_error','=',True)]}">进仓日期</span>
                                </th>

                                <th width="8%">
                                    <span style="color:red" attrs="{'invisible':[('plan_date_ship_error','=',False)]}">
                                        出运船日期
                                    </span>
                                    <span attrs="{'invisible':[('plan_date_ship_error','=',True)]}">出运船日期</span>
                                </th>
                                <th width="8%">
                                    <span style="color:red"
                                          attrs="{'invisible':[('plan_date_customer_finish_error','=',False)]}">向客户交单
                                    </span>
                                    <span attrs="{'invisible':[('plan_date_customer_finish_error','=',True)]}">向客户交单
                                    </span>
                                </th>
                                <th width="16%">日志备注</th>
                                <th width="4%"></th>

                            </tr>
                            <tr>
                                <td>
                                    <field name="tb_id" readonly="1"/>
                                </td>
                                <td>
                                    <field name="approve_date" readonly="1"/>
                                </td>
<!--                                <td>-->
<!--                                    <field name="sale_invoice_balance"/>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <field name="purchase_invoice_balance"/>-->
<!--                                </td>-->
<!--                                <td>-->
<!--                                    <field name="back_tax_invoice_balance"/>-->
<!--                                </td>-->

                                <td style="color:red" attrs="{'invisible':[('is_date_out_in','=',True)]}">

                                    <field name="date_out_in" readonly="1"/>
                                    <button name="open_activity_id_date_out_in" type="object" icon="fa-clock-o"
                                            attrs="{'invisible':['|',('plan_date_out_in_activity','=',False),('type','!=','transport_track')]}"/>
                                    <button name="action_date_out_in" type="object" icon="fa-check"
                                            confirm="确认后，应收应付就会生成，请谨慎！"
                                            attrs="{'invisible':['|',('plan_date_out_in_activity','!=',False),('type','!=','transport_track')]}"
                                    />
                                </td>
                                <td attrs="{'invisible':[('is_date_out_in','=',False)]}">
                                    <field name="date_out_in"
                                           attrs="{'readonly':1}"/>

                                </td>
                                <td>
                                    <field name="date_ship"
                                           attrs="{'readonly':['|',('is_date_out_in','=',False),('plan_date_ship_activity','!=',False)]}"/>
                                    <button name="open_activity_id_date_ship" type="object" icon="fa-clock-o"
                                            attrs="{'invisible':['|',('plan_date_ship_activity','=',False),('type','!=','transport_track')]}"/>

                                </td>
                                <td>
                                    <field name="date_customer_finish"
                                           attrs="{'readonly':['|',('is_date_out_in','=',False),('plan_date_customer_finish_activity','!=',False)]}"/>
                                    <button name="open_activity_id_customer_finish" type="object" icon="fa-clock-o"
                                            attrs="{'invisible':['|',('plan_date_customer_finish_activity','=',False),('type','!=','transport_track')]}"/>
                                </td>
                                <td>
                                    <field name="comments_transport_track" readonly="1"/>
                                </td>
                                <td>
                                    <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                                </td>

                            </tr>
                            <tr groups="base.group_system,sale.hegui_all,sales_team.group_manager">
                                <td>日期计划</td>
                                <td></td>
<!--                                <td></td>-->
<!--                                <td></td>-->
<!--                                <td></td>-->
                                <td>
                                    <field name="plan_date_out_in" readonly="1"/>
                                </td>
                                <td>
                                    <field name="plan_date_ship" readonly="1"/>
                                </td>
                                <td>
                                    <field name="plan_date_customer_finish" readonly="1"/>
                                </td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>


                    <notebook colspan="4" attrs="{'invisible':[('type','=','order_track')]}">
                        <page string="明细">

                            <field name="plan_check_ids"
                                   context="{'form_view_ref':'yjzy_extend.plan_check_form' ,'open':1}"
                                   attrs="{'readonly':[('order_track_new_order_state','=','20_done')]}">
                                <tree editable="bottom" delete="false" create="false"
                                      decoration-danger="check_on_time == '20_out_time_un_finish'">
                                    <field name="order_track_id" groups="base.group_system"/>
                                    <field name="so_id" groups="base.group_system"/>
                                    <field name="po_id" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','=','transport_track')]}"/>
                                    <field name="plan_check_line" groups="base.group_system"/>
                                    <field name="date_factory_return"
                                           attrs="{'column_invisible':[('parent.type','!=','new_order_track')]}"/>
                                    <field name="check_on_time" invisible="1"/>
                                    <field name="tb_id" invisible="1"/>
                                    <field name="purchase_invoice_id" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','transport_track')]}"/>
                                    <field name="supplier_delivery_date" string='工厂实际发货日'
                                           options='{"fg_color": "red:is_supplier_delivery_date_earlier_approve_date == True"}'
                                           attrs="{'readonly':[('parent.order_track_new_order_state','=','20_done')],'column_invisible':[('parent.type','!=','transport_track')]}"/>
                                    <button name="confirm_supplier_delivered_date" string="确认" type="object"
                                            attrs="{'invisible':['|',('is_supplier_delivery_date_done','=',True),('parent.type','!=','transport_track')]}"/>
                                    <field name="is_supplier_delivery_date_done" invisible="1"/>
                                    <field name="is_supplier_delivery_date_earlier_approve_date" invisible="1"/>
                                    <field name="purchase_invoice_date_finish" invisible="1"
                                           attrs="{'readonly':[('parent.order_track_new_order_state','=','20_done')]}"/>

                                    <field name="order_track_plan_number" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','order_track')]}"/>
                                    <field name="order_track_finish_number" readonly="1" help=""
                                           attrs="{'column_invisible':[('parent.type','!=','order_track')]}"/>
                                    <field name="order_track_due_number" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','order_track')]}"/>
                                    <field name="order_track_due_finish_number" readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','order_track')]}"/>
                                    <field name="order_track_time_out_finish_number" class="akiny_text_left"
                                           readonly="1"
                                           attrs="{'column_invisible':[('parent.type','!=','order_track')]}"/>

                                    <field name="date_deadline" invisible="1"/>
                                    <field name="date_finish" invisible="1"/>
                                    <field name="plan_check_att_count"
                                           attrs="{'column_invisible':[('parent.type','=','new_order_track')]}"/>
                                    <button name="open_self" type="object" icon="fa-paperclip"
                                            attrs="{'column_invisible':[('parent.type','=','new_order_track')]}"/>
                                    <field name="comments" readonly="1"/>
                                    <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                                    <button name="open_planning_integrity" type="object" string="检查点计划登记"
                                            invisible="context.get('type')!='order_track'" groups="base.group_system"/>


                                </tree>
                                <form string="检查点">
                                    <sheet>
                                        <group>
                                            <group>
                                                <field name="date_factory_return" readonly="1"
                                                       attrs="{'invisible':[('type','!=','new_order_track')]}"/>

                                            </group>
                                            <group>
                                                <field name="comments"/>
                                            </group>
                                        </group>
                                        <notebook colspan="4">
                                            <page string="General Information"
                                                  attrs="{'invisible':[('type','!=','order_track')]}">
                                                <field name="plan_check_line">
                                                    <tree>
                                                        <field name="activity_type_1_id" readonly="1"/>
                                                        <button name="open_activity_id_plan" class="akiny_text_right"
                                                                type="object"
                                                                icon="fa-archive"
                                                                attrs="{'invisible':1}"/>

                                                        <field name="date_deadline"/>
                                                        <button name="open_activity_id_finish" class="akiny_text_right"
                                                                type="object"
                                                                icon="fa-archive"
                                                                attrs="{'invisible':1}"/>

                                                        <field name="date_finish"/>
                                                        <field name="plan_check_id"/>

                                                        <button name="open_activity_id" type="object" string="登记该项检查点"
                                                                groups="base.group_system"
                                                                attrs="{'invisible':[('plan_check_id','=',False)]}"/>
                                                    </tree>
                                                </field>
                                            </page>
                                            <page string="manager" groups="base.system">
                                                <field name="type"/>


                                            </page>

                                        </notebook>

                                    </sheet>
                                    <footer invisible="not context.get('open')">
                                        <button name="action_save_test" type="object" class="oe_highlight"
                                                string="保存并关闭"/>
                                        <button string="关闭" class="btn-primary" special="cancel"/>
                                    </footer>
                                    <div class="oe_chatter">
                                        <field name="message_follower_ids" widget="mail_followers"/>
                                        <field name="activity_ids" widget="mail_activity"/>
                                        <field name="message_ids" widget="mail_thread"/>
                                    </div>
                                </form>
                            </field>
                            <field name="plan_check_line_ids"
                                   attrs="{'invisible':[('type','!=','order_track')],'readonly':[('order_track_new_order_state','=','20_done')]}">
                                <tree string="检查点" create="false" editable="bottom"
                                      decoration-danger="remaining_time &lt;= 0 and remaining_time != -999">
                                    <field name="po_id" attrs="{'readonly':1}"/>
                                    <!--                                    <field name="date_order" widget="date" readonly="1"/>-->
                                    <field name="activity_type_1_id" domain="[('category','=','plan_check')]"
                                           options="{'no_open':1}"
                                           attrs="{'readonly':[('parent.order_track_new_order_state','=','20_done')]}"/>
                                    <button name="open_activity_id_plan" class="akiny_text_right" type="object"
                                            attrs="{'invisible':[('activity_id','=',False)],'readonly':['|',('activity_id','!=',False),('parent.order_track_new_order_state','=','20_done')]}"
                                            icon="fa-clock-o"/>
                                    <field name="date_deadline"
                                           attrs="{'readonly':['|',('activity_id','!=',False),('parent.order_track_new_order_state','=','20_done')]}"/>
                                    <field name="remaining_time" readonly="1"
                                           attrs="{'invisible':['|',('state','in',['40_finish','50_time_out_finish']),('remaining_time','=',-999)],'column_invisible':[('parent.order_track_new_order_state','=','20_done')]}"/>
                                    <button name="open_activity_id_finish" class="akiny_text_right" type="object"
                                            attrs="{'invisible':['|',('activity_id','=',False),('date_deadline','=',False)]}"
                                            icon="fa-check-circle"/>
                                    <field name="date_finish"
                                           attrs="{'readonly':['|',('activity_id','!=',False),('parent.order_track_new_order_state','=','20_done')]}"/>
                                    <field name="plan_check_line_att_count"/>
                                    <button name="open_self" type="object" icon="fa-paperclip"/>
                                    <field name="comments_line"/>
                                    <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                                    <field name="activity_id" groups="base.group_system"/>
                                    <field name="state"/>

                                    <button name="open_activity_id" type="object" string="登记该项检查点"
                                            groups="base.group_system"/>
                                </tree>
                            </field>
                        </page>
                        <page string="采购合同" invisible="not context.get('order_track')">
                            <field name="po_ids" readonly="1">
                                <tree>
                                    <field name="message_unread" invisible="1"/>
                                    <field name="name" string="流水码" groups="base.group_system" invisible="1"/>
                                    <field name="contract_code" string="合同编号"/>
                                    <field name="partner_id"/>
                                    <field name="date_order" string="下单日期" widget="date" invisible="1"/>
                                    <field name="create_date" widget="date" invisible="1"/>
                                    <field name="date_order" widget="date"/>
                                    <field name="date_planned" invisible="context.get('quotation_only', False)"
                                           string="交期" widget="date"/>
                                    <field name="date_factory_return" string="工厂回传日"/>
                                    <field name="origin" invisible="1"/>
                                    <field name="amount_untaxed" sum="Total Untaxed amount" string="Untaxed"
                                           widget="monetary" invisible="1"/>
                                    <field name="amount_total" sum="Total amount" string="金额" widget="monetary"/>
                                    <field name="balance" string="预付余额"/>
                                    <field name="currency_id" invisible="1"/>
                                    <field name="state" invisible="1"/>
                                    <field name="delivery_status" invisible="1"/>
                                    <field name="include_tax"/>
                                    <field name="payment_term_id" attrs="{}" invisible="1"/>
                                    <field name="sale_uid"/>
                                    <field name="sale_assistant_id" invisible="1"/>
                                    <field name="purchaser_date"/>
                                    <field name="so_id_state" string="销售审批状态" invisible="1"/>
                                    <field name="gongsi_id" string="采购主体" invisible="1"/>
                                    <field name="supplierinfo_ids" widget="many2many_tags" invisible="1"/>
                                    <field name="invoice_status"
                                           invisible="1"/><!--invisible="not context.get('show_purchase', True)"-->
                                    <field name="company_id" groups="base.group_system" invisible="1"
                                           options="{'no_create': True}"/>

                                </tree>
                            </field>
                        </page>
                        <page groups="base.group_system">
                            <group>
                                <field name="date_so_requested_is_out_time"/>
                                <field name="comments_new_order_track_date"/>
                                <field name="comments_order_track_date"/>
                                <field name="comments_transport_track_date"/>
                                <field name="partner_id"/>
                                <field name="is_date_out_in"/>
                                <field name="order_track_transport_state"/>
                                <field name="order_track_transport"/>
                                <field name="plan_date_out_in_activity" invisible="1"/>
                                <field name="plan_date_customer_finish_activity" invisible="1"/>
                                <field name="plan_date_ship_activity" invisible="1"/>
                                <field name="type" invisible="1"/>
                                <field name="is_date_out_in" invisible="1"/>
                                <field name="plan_date_customer_finish_error"/>
                                <field name="plan_date_out_in_error"/>
                                <field name="plan_date_ship_error"/>
                                <field name="check_all_number"/>
                                <field name="check_finish_number"/>
                            </group>
                        </page>


                    </notebook>
                    <footer invisible="not context.get('open')">
                        <button name="action_save_test" type="object" class="oe_highlight" string="保存并关闭"/>
                        <button string="关闭" class="btn-primary" special="cancel"/>
                    </footer>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>


    <record id="order_track_form_plan_check_ids" model="ir.ui.view">
        <field name="name">order.track.form</field>
        <field name="model">order.track</field>
        <field name="arch" type="xml">
            <form string="计划" create="false">
                <sheet>
                    <field name="plan_check_ids" nolabel="1">
                        <tree editable="bottom" delete="false">
                            <field name="order_track_id" groups="base.group_system"/>
                            <field name="so_id" groups="base.group_system"/>
                            <field name="po_id" readonly="1"/>
                            <field name="plan_check_line" groups="base.group_system"/>
                            <field name="date_deadline"/>
                            <field name="date_finish"/>
                            <field name="state"/>
                            <button name="open_plan_check_ids" type="object" string="检查点检查登记"/>
                        </tree>
                    </field>

                </sheet>

                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>


    <record id="plan_check_tree_view" model="ir.ui.view">
        <field name="name">plan.check.tree</field>
        <field name="model">plan.check</field>
        <field name="arch" type="xml">
            <tree string="检查点">
                <field name="date_deadline"/>
                <field name="so_id"/>
            </tree>
        </field>
    </record>


    <record id="plan_check_form" model="ir.ui.view">
        <field name="name">plan.check.form</field>
        <field name="model">plan.check</field>
        <field name="arch" type="xml">
            <form string="检查点">
                <sheet>
                    <group>
                        <group>
                            <field name="date_factory_return" readonly="1"/>

                        </group>
                        <group>
                            <field name="comments"/>
                        </group>
                    </group>
                    <notebook colspan="4">
                        <page string="General Information" attrs="{'invisible':[('type','!=','order_track')]}">
                            <field name="plan_check_line">
                                <tree>
                                    <field name="activity_type_1_id" readonly="1"/>
                                    <button name="open_activity_id_plan" class="akiny_text_right" type="object"
                                            icon="fa-archive" attrs="{'invisible':[('plan_check_id','=',False)]}"/>

                                    <field name="date_deadline"/>
                                    <button name="open_activity_id_finish" class="akiny_text_right" type="object"
                                            icon="fa-archive" attrs="{'invisible':[('plan_check_id','=',False)]}"/>

                                    <field name="date_finish"/>
                                    <field name="plan_check_id"/>

                                    <button name="open_activity_id" type="object" string="登记该项检查点"
                                            groups="base.group_system"
                                            attrs="{'invisible':[('plan_check_id','=',False)]}"/>
                                </tree>
                            </field>
                        </page>
                        <page string="manager" groups="base.system">
                            <field name="type"/>


                        </page>

                    </notebook>
                    <footer invisible="not context.get('open')">
                        <button name="action_save_test" type="object" class="oe_highlight" string="保存并关闭"/>
                        <button string="关闭" class="btn-primary" special="cancel"/>
                    </footer>
                </sheet>

                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="plan_check_line_tree_view" model="ir.ui.view">
        <field name="name">plan.check.line.tree</field>
        <field name="model">plan.check.line</field>
        <field name="arch" type="xml">
            <tree string="检查点" default_order="date_deadline,activity_type_1_id_sequence" create="false"
                  decoration-danger="remaining_time &lt;= 0 and remaining_time != -999">
                <field name="po_id"/>
                <field name="supplier_id"/>
                <field name="activity_type_1_id"/>
                <button name="open_activity_id_plan" class="akiny_text_right"
                        attrs="{'invisible':[('activity_id','=',False)],}" type="object" icon="fa-clock-o"/>
                <field name="date_deadline"/>
                <field name="remaining_time" readonly="1"
                       attrs="{'invisible':['|',('state','in',['40_finish','50_time_out_finish']),('remaining_time','=',-999)]}"/>
                <button name="open_activity_id_finish" class="akiny_text_right" type="object"
                        attrs="{'invisible':['|',('activity_id','=',False),('date_deadline','=',False)]}"
                        icon="fa-check-circle"/>
                <field name="date_finish"/>
                <field name="plan_check_line_att_count"/>
                <button name="open_self" type="object" icon="fa-paperclip"/>
                <field name="comments_line"/>
                <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                <field name="activity_id" invisible="1"/>
                <field name="state"/>
                <field name="activity_type_1_id_sequence" invisible="1"/>
                <button name="open_activity_id" type="object" string="登记该项检查点" groups="base.group_system"/>
            </tree>
        </field>
    </record>


    <record id="plan_check_line_kanban_view" model="ir.ui.view">
        <field name="name">plan.check.line.kanban</field>
        <field name="model">plan.check.line</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="po_id"/>
                <field name="activity_type_1_id"/>
                <field name="activity_type_1_id_name"/>
                <field name="date_deadline"/>
                <field name="date_finish"/>
                <field name="state"/>
                <field name="po_contract_code"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                            <div class="o_kanban_record_top mb16">
                                <div class="o_kanban_record_headings mt4">
                                    <strong class="o_kanban_record_title">
                                        <span>
                                            <t t-esc="record.po_contract_code.value"/>
                                        </span>
                                    </strong>
                                </div>

                            </div>
                            <div class="o_kanban_record_bottom">
                                <div class="oe_kanban_bottom_left text-muted">
                                    <span>
                                        <t t-esc="record.activity_type_1_id_name.value"/>
                                    </span>
                                </div>
                                <div class="oe_kanban_bottom_right">
                                    <field name="state" widget="label_selection"
                                           options="{'classes': {'draft': 'default', 'cancel': 'default', 'done': 'success'}}"/>
                                </div>
                            </div>
                            <div class="o_kanban_record_bottom">
                                <div class="oe_kanban_bottom_left text-muted">
                                    <span>
                                        <span>计划：</span>
                                        <t t-esc="record.date_deadline.value"/>
                                    </span>
                                </div>
                                <div class="oe_kanban_bottom_right">
                                    <span>到期：</span>
                                    <t t-esc="record.date_finish.value"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="order_track_kanban_view" model="ir.ui.view">
        <field name="name">order.track.kanban</field>
        <field name="model">order.track</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="tb_id"/>
                <field name="date_out_in"/>
                <field name="date_ship"/>
                <field name="date_customer_finish"/>
                <field name="tb_purchase_invoice_ids"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                            <div class="o_kanban_record_top mb16">
                                <div class="o_kanban_record_headings mt4">
                                    <strong class="o_kanban_record_title">
                                        <span>
                                            <t t-esc="record.tb_id.value"/>
                                        </span>
                                    </strong>
                                </div>

                            </div>
                            <div class="o_kanban_record_bottom">
                                <div class="oe_kanban_bottom_left text-muted">
                                    <span>
                                        <t t-esc="record.date_out_in.name"/>
                                    </span>
                                </div>
                                <div class="oe_kanban_bottom_right">
                                    <field name="date_ship"/>
                                </div>
                            </div>
                            <div class="o_kanban_record_bottom">
                                <div class="oe_kanban_bottom_left text-muted">
                                    <span>
                                        <span>计划：</span>
                                        <t t-esc="record.date_customer_finish.value"/>
                                    </span>
                                </div>
                                <div class="oe_kanban_bottom_right">
                                    <span>到期：</span>
                                    <t t-esc="record.date_customer_finish.value"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>


    <record id="plan_check_line_form" model="ir.ui.view">
        <field name="name">plan.check.line.form</field>
        <field name="model">plan.check.line</field>
        <field name="arch" type="xml">
            <form string="检查点">
                <style>
                    body{
                    font-size: 10px;
                    font-family:Arial;
                    }
                    .tablelist{

                    text-align: center;
                    border: 0.5px solid ;
                    border-collapse: collapse;
                    font-size: 10px;
                    width: 100%
                    }
                    .tablelist th{

                    font-size: 10px;
                    text-align: center;
                    border: 0.5px solid ;
                    height: 20px;
                    line-height: 20px;
                    }
                    .tablelist td{
                    border: 0.5px solid;
                    height: 20px;
                    line-height: 20px;

                    }
                </style>
                <sheet>
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="tablelist"
                    >
                        <tbody>
                            <tr>
                                <th width="15%">采购合同</th>
                                <th width="15%">检查类型</th>
                                <th width="15%">检查点计划时间</th>
                                <th width="15%">检查点完成时间</th>

                                <th width="36%">最后一次备注</th>
                                <th width="4%"></th>
                            </tr>
                            <tr>
                                <td>
                                    <field name="po_id" readonly="1"/>
                                </td>
                                <td>
                                    <field name="activity_type_1_id" readonly="1" options="{'no_create':1}"/>
                                </td>
                                <td>
                                    <button name="open_activity_id_plan" class="akiny_text_right" type="object"
                                            icon="fa-clock-o" attrs="{'invisible':[('date_deadline','!=',False)]}"/>
                                    <field name="date_deadline"
                                           attrs="{'readonly':[('activity_id','=',False)]}"/>
                                </td>
                                <td>
                                    <button name="open_activity_id_finish" class="akiny_text_right" type="object"
                                            icon="fa-check-circle" attrs="{'invisible':[('date_finish','!=',False)]}"/>
                                    <field name="date_finish"
                                           attrs="{'readonly':[('activity_id','=',False)]}"/>
                                </td>

                                <td>
                                    <field name="comments_line" readonly="1"/>
                                </td>
                                <td>
                                    <button name="open_wizard_comments" type="object" icon="fa-commenting-o"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <!--                    <group>-->
                    <!--                        <field name="po_id"/>-->
                    <!--                        <field name="activity_type_1_id"/>-->
                    <!--                        <button name="open_activity_id_plan" class="akiny_text_right" type="object" icon="fa-archive"/>-->
                    <!--                        <field name="date_deadline"/>-->
                    <!--                        <button name="open_activity_id_finish" class="akiny_text_right" type="object"-->
                    <!--                                icon="fa-archive"/>-->
                    <!--                        <field name="date_finish"/>-->

                    <!--                        <button name="open_activity_id" type="object" string="登记该项检查点" groups="base.group_system"/>-->
                    <!--                    </group>-->
                </sheet>
                <field name="activity_id" invisible="1"/>

                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="action_plan_check_line" model="ir.actions.act_window">
        <field name="name">所有检查点</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">plan.check.line</field>
        <field name="view_mode">tree,form,kanban</field>
        <field name="search_view_id" ref="view_plan_check_line_search"/>
        <field name="domain">[('order_track_id_state','=','10_doing')]</field>
        <field name="context">{}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('plan_check_line_tree_view')}),
                          (0, 0, {'view_mode': 'kanban', 'view_id': ref('plan_check_line_kanban_view')}),
                           (0, 0, {'view_mode': 'form', 'view_id': ref('plan_check_line_form')})]"/>
    </record>

    <record id="action_new_order_track" model="ir.actions.act_window">
        <field name="name">新订单下单前跟踪</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">order.track</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('type','=','new_order_track'),('order_track_new_order_state','=','10_doing')]</field>
        <field name="context">{'type': 'new_order_track','factory_return':1,}
        </field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('order_track_tree_view')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('order_track_form_new')})]"/>

    </record>
    <record id="action_new_order_track_done" model="ir.actions.act_window">
        <field name="name">已完成新订单下单前跟踪</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">order.track</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('type','=','new_order_track'),('order_track_new_order_state','=','20_done')]</field>
        <field name="context">{'type': 'new_order_track','factory_return':1,}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('order_track_tree_view')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('order_track_form_new')})]"/>

    </record>

    <record id="action_order_track" model="ir.actions.act_window">
        <field name="name">订单跟踪</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">order.track</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">
            [('type','=','order_track'),('order_track_new_order_state','=','10_doing'),('so_po_return_state','=','returned'),]
        </field>
        <field name="context">{'search_default_group_ddate_so_requested_is_out_time':1,'type': 'order_track'}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('order_track_tree_view')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('order_track_form_new')})]"/>

    </record>

    <record id="action_order_track_out_date" model="ir.actions.act_window">
        <field name="name">逾期订单跟踪</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">order.track</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_order_track_search"/>
        <field name="domain">
            [('type','=','order_track'),('order_track_new_order_state','=','10_doing'),('so_po_return_state','=','returned'),
            ('date_so_requested_is_out_time','=','40_in_out_time')]
        </field>
        <field name="context">{'type': 'order_track','type_out':'out_date','search_default_group_date_so_requested_new_state':1}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('order_track_tree_view_out_time')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('order_track_form_new')})]"/>

    </record>

    <record id="action_plan_check_po" model="ir.actions.act_window">
        <field name="name">采购合同跟踪</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">plan.check</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_plan_check_search"/>
        <field name="domain">
            [('type','=','order_track'),('order_track_id_state','=','10_doing'),('so_po_return_state','=','returned')]
        </field>
        <field name="context">{'search_default_group_date_po_planned_is_out_time':1}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('plan_check_tree_view_purchase_order')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('plan_check_form_purchase_order')})]"/>

    </record>
    <record id="action_plan_check_po_out_date" model="ir.actions.act_window">
        <field name="name">逾期采购合同跟踪</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">plan.check</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_plan_check_search"/>
        <field name="domain">
            [('type','=','order_track'),('order_track_id_state','=','10_doing'),('so_po_return_state','=','returned'),
            ('date_po_planned_is_out_time','=','40_in_out_time')]
        </field>
        <field name="context">{'type_out':'out_date','search_default_group_date_po_planned_is_out_time':1}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('plan_check_tree_view_purchase_out_time_order')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('plan_check_form_purchase_order')})]"/>

    </record>
    <record id="action_order_track_done" model="ir.actions.act_window">
        <field name="name">已完成订单跟踪</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">order.track</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('type','=','order_track'),('order_track_new_order_state','=','20_done')]</field>
        <field name="context">{'type': 'order_track',}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('order_track_tree_view')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('order_track_form_new')})]"/>

    </record>


    <record id="action_order_track_tb" model="ir.actions.act_window">
        <field name="name">出运相关日期跟踪</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">order.track</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">
            [('type','=','transport_track'),('date_all_state','not in',['50_payable_done','30_un_done'])]
        </field>
        <!--        ('order_track_new_order_state','in',['10_doing','15_receivable_payment']),-->
        <field name="search_view_id" ref="view_order_track_search"/>
        <field name="context">{'search_default_group_date_all_state':1,'type':'transport_track','supplier_delivery_date':1}
        </field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('order_track_tree_view')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('order_track_form_new')})]"/>

    </record>

    <record id="action_order_track_tb_done" model="ir.actions.act_window">
        <field name="name">已完成出运跟踪</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">order.track</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('type','=','transport_track'),('date_all_state','=','50_payable_done')]</field>
        <!--        ('order_track_new_order_state','=','20_done')-->
        <field name="search_view_id" ref="view_order_track_search"/>
        <field name="context">{'type': 'transport_track','supplier_delivery_date':1}
        </field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('order_track_tree_view')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('order_track_form_new')})]"/>
    </record>

    <record id="action_order_track_all" model="ir.actions.act_window">
        <field name="name">所有订单跟踪</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">order.track</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[]</field>
        <field name="context">{}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('order_track_tree_view_all')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('order_track_form_new')})]"/>


    </record>
    <menuitem id="menu_order_track_done_root" name="已完成" parent="menu_order_track_root"
              sequence="9"/>
    <menuitem id="menu_order_track_root" name="合同跟踪" sequence="99" groups="sales_team.group_manager"/>
    <menuitem id="menu_new_order_track" name="新订单下单前跟踪" parent="menu_order_track_root" action="action_new_order_track"
              sequence="1"/>
    <menuitem id="menu_new_order_track_done" name="新订单下单前跟踪" parent="menu_order_track_done_root"
              action="action_new_order_track_done"
              sequence="1"/>
    <menuitem id="menu_order_track" name="订单跟踪" parent="menu_order_track_root" action="action_order_track"
              sequence="2"/>
    <menuitem id="menu_order_track_out_date" name="逾期订单跟踪" parent="menu_order_track_root"
              action="action_order_track_out_date"
              sequence="3"/>
    <menuitem id="menu_plan_check_po" name="采购合同跟踪" parent="menu_order_track_root" action="action_plan_check_po"
              sequence="4"/>
    <menuitem id="menu_plan_check_po_out_date" name="逾期采购合同跟踪" parent="menu_order_track_root" action="action_plan_check_po_out_date"
              sequence="5"/>



    <menuitem id="menu_order_track_done" name="订单跟踪" parent="menu_order_track_done_root"
              action="action_order_track_done"
              sequence="2"/>


    <menuitem id="menu_order_track_tb" name="出运相关日期跟踪" parent="menu_order_track_root" action="action_order_track_tb"
              sequence="7"/>
    <menuitem id="menu_order_track_tb_done" name="出运跟踪" parent="menu_order_track_done_root"
              action="action_order_track_tb_done"
              sequence="3"/>

    <menuitem id="menu_plan_check" name="所有检查点" parent="menu_order_track_root" action="action_plan_check_line"
              sequence="6"/>
    <menuitem id="menu_customer_invoice_for_sales" name="客户应收" parent="menu_order_track_root"
              action="action_customer_invoice_all_for_sales"
              sequence="8"/>

    <menuitem id="menu_action_order_track_all" name="所有跟踪" parent="menu_order_track_root" groups="base.group_system"
              action="action_order_track_all"
              sequence="99"/>


</odoo>